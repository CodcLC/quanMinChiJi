{"version":3,"sources":["assets\\scripts\\ui\\SkinItem.js"],"names":["cc","Class","Component","properties","actorAnim","sp","Skeleton","nameUI","Label","skinData","methodBtnGroup","Node","onLoad","GameApp","eventManager","on","EventNames","EVENT_UPDATE_SHOP_CHOOSED_SHOW","updateUnLockShow","bind","onDestroy","removeListener","init","_skinData","initNameShow","initSkinShow","updateMethodShow","string","name","colorIndex","Math","floor","skinid","node","color","Color","fromHEX","NameColor","skeletonData","uiManager","normalSkinData","setSkin","skinname","advanceSkinDataGroup","setAnimation","setCompleteListener","Tools","randomNum","children","getComponent","dataManager","userData","havePieceNum","needpiece","setpieceIcon","active","needcoin","needgem","playedVideoNum","unlockarr","unLockedSkinIdArr","concat","sort","a","b","forEach","element","updateChoosedShow","getChoosedSkinId","id","self","loader","loadRes","SpriteFrame","err","spriteFrame","Sprite","frameBtnClick","audioManager","playEffect","showPopup","selelctBtnClick","setChoosedSkinId","emit"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        actorAnim: sp.Skeleton,\r\n        nameUI: cc.Label,\r\n        skinData: {\r\n            default: {}\r\n        },\r\n        methodBtnGroup: [cc.Node]\r\n    },\r\n\r\n    onLoad() {\r\n        GameApp.eventManager.on(EventNames.EVENT_UPDATE_SHOP_CHOOSED_SHOW, this.updateUnLockShow.bind(this))\r\n    },\r\n    onDestroy() {\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_UPDATE_SHOP_CHOOSED_SHOW)\r\n    },\r\n    // update (dt) {},\r\n    init(_skinData) {\r\n        this.skinData = _skinData\r\n        this.initNameShow()\r\n        this.initSkinShow()\r\n        this.updateMethodShow()\r\n    },\r\n    initNameShow() {\r\n        this.nameUI.string = this.skinData.name\r\n        var colorIndex = Math.floor((this.skinData.skinid - 1) / 5)\r\n        this.nameUI.node.color = new cc.Color().fromHEX(NameColor[colorIndex]);\r\n    },\r\n    initSkinShow() {\r\n        if (this.skinData.skinid < 21) {\r\n            this.actorAnim.skeletonData = GameApp.uiManager.normalSkinData\r\n            this.actorAnim.setSkin(this.skinData.skinname)\r\n        } else {\r\n            this.actorAnim.skeletonData = GameApp.uiManager.advanceSkinDataGroup[this.skinData.skinid - 21]\r\n        }\r\n        if (this.skinData.skinid < 21) {\r\n            this.actorAnim.setAnimation(0, 'await', true)\r\n        } else {\r\n            this.actorAnim.setAnimation(0, 'await_main_1', false)\r\n            this.actorAnim.setCompleteListener(() => {\r\n                this.actorAnim.setAnimation(0, 'await_main_' + Tools.randomNum(1, 3), false)\r\n            })\r\n        }\r\n    },\r\n    updateMethodShow() {\r\n\r\n        if (this.skinData.skinid > 25) {\r\n            this.methodBtnGroup[2].children[1].getComponent(cc.Label).string = GameApp.dataManager.userData.havePieceNum[this.skinData.skinid] + '/' + this.skinData.needpiece\r\n            this.setpieceIcon(this.skinData.skinid)\r\n        }\r\n        this.updateUnLockShow()\r\n    },\r\n    updateUnLockShow() {\r\n        this.methodBtnGroup[0].active = this.skinData.needcoin\r\n        this.methodBtnGroup[1].active = this.skinData.needgem\r\n        this.methodBtnGroup[2].active = this.skinData.needpiece\r\n        this.methodBtnGroup[3].active = false\r\n        this.methodBtnGroup[0].children[1].getComponent(cc.Label).string = this.skinData.needcoin\r\n        this.methodBtnGroup[1].children[1].getComponent(cc.Label).string = GameApp.dataManager.userData.playedVideoNum + '/' + this.skinData.needgem\r\n\r\n        var unlockarr = GameApp.dataManager.userData.unLockedSkinIdArr.concat()\r\n        unlockarr.sort((a, b) => a - b);\r\n        unlockarr.forEach(element => {\r\n            if (element == this.skinData.skinid) {\r\n                this.methodBtnGroup[0].active = false;\r\n                this.methodBtnGroup[1].active = false;\r\n                this.methodBtnGroup[2].active = false;\r\n                this.methodBtnGroup[3].active = true;\r\n                return;\r\n            }\r\n        });\r\n        this.updateChoosedShow()\r\n    },\r\n    updateChoosedShow() {\r\n        if (GameApp.dataManager.getChoosedSkinId() == this.skinData.skinid) {\r\n            this.methodBtnGroup[3].children[0].active = false\r\n            this.methodBtnGroup[3].children[1].active = true\r\n        } else {\r\n            this.methodBtnGroup[3].children[0].active = true\r\n            this.methodBtnGroup[3].children[1].active = false\r\n        }\r\n    },\r\n    setpieceIcon(id) {\r\n        var self = this\r\n        cc.loader.loadRes(\"texture/skin_piece/card_p_\" + id, cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.methodBtnGroup[2].children[0].getComponent(cc.Sprite).spriteFrame = spriteFrame\r\n        });\r\n    },\r\n    frameBtnClick() {\r\n        GameApp.audioManager.playEffect('click')\r\n        GameApp.uiManager.showPopup(\"SkinInfoPopup\", (node) => {\r\n            node.getComponent(\"SkinInfoPopup\").init(this.skinData)\r\n        }, false)\r\n    },\r\n    selelctBtnClick() {\r\n        GameApp.audioManager.playEffect('click')\r\n        GameApp.dataManager.setChoosedSkinId(this.skinData.skinid)\r\n        GameApp.eventManager.emit(EventNames.EVENT_UPDATE_SHOP_CHOOSED_SHOW)\r\n    },\r\n});\r\n"]}