{"version":3,"sources":["assets\\scripts\\game\\Player.js"],"names":["cc","Class","Component","properties","moveDir","v2","displayName","tooltip","_speedType","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","roleAnim","sp","Skeleton","_gunDir","gunAnim","gunNode","Node","_haveGun","gunData","skinData","_pbc","PhysicsBoxCollider","nameUI","Label","bulletPrefab","Prefab","tempGroundWeapon","hpBar","ProgressBar","amoBar","starNode","lastHitBullet","_isAim","_aimTimer","_aimInterval","_stepTimer","_stepInterval","_isDie","arrowNode","_mapNoGun","_isProtect","_isGas","_inGasTimer","_inGasInterval","onLoad","GameApp","eventManager","on","EventNames","EVENT_PLAYER_SHOOT","shoot","bind","EVENT_PLAYER_RELOAD","reload","EVENT_PICKUP_WEAPON","pickUpWeapon","EVENT_UPDATE_TOPBAR_SHOW","updatePlayerTopBarShow","EVENT_AIM","aimState","EVENT_THEGAMESTART","theGameStart","EVENT_FLASH","doFlash","EVENT_RESUME_HEALTH","doResumeHealth","EVENT_UPDATE_STAR_SHOW","updateStarShow","getComponent","tag","Tags","player","onEnable","onDisable","onDestroy","removeListener","init","dataManager","globalData","isInGame","roleProtect","jsonData","SkinsData","userData","choosedSkinId","initNameShow","initSkinShow","audioManager","playEffect","active","node","opacity","move","resumeHealth","getResumeHealthNum","_num","runAction","sequence","callFunc","uiManager","showGameObject","RichText","string","addHp","setPosition","seq","spawn","fadeIn","scaleTo","moveTo","fadeOut","destroy","delayTime","repeat","_sum","i","getItemAttrArr","rank","level","parseInt","starNum","children","Sprite","spriteFrame","commonAtlas","getSpriteFrame","playerName","skeletonData","normalSkinData","setSkin","skinname","advanceSkinDataGroup","arr","setAnimation","progress","curHp","maxHp","curAmoNum","maxAmoNum","dt","_flash","_borderGroup","getGame","enemySpawnPosGroupNode","newPos1","position","add","mul","x","y","theAngle","misc","radiansToDegrees","Math","atan2","scaleX","newPos","emit","EVENT_UPDATE_MIPMAP_PLAYER","setSpeedType","_type","setDir","_dir","setGunDir","rotation","scaleY","setArrowDir","parent","update","lifeTime","NORMAL","curSpeed","FAST","floor","getEquipItemAttr","EquipType","speed","checkGas","arrowToNearestGun","aimToNearest","lateUpdate","mapCamera","gasConfig","distance","safePosition","sub","mag","gasCircle","beDamage","event","allRoleArr","concat","Tools","removeArray","minDis","index","length","range","dir","aimEnemy","normalize","allGunArr","aimGun","reduceAmo","power","ceil","curDamage","damage","isCrit","curCrit","crit","weaponid","bullet1","instantiate","bullet2","bullet3","bulletPos","convertToNodeSpaceAR","convertToWorldSpaceAR","cloneGunDir","bulletC1","_belongTag","_belongName","_flyDir","bulletC2","rotate","degreesToRadians","bulletC3","bullet","bulletC","getUI","uiRoot","name","reloadBtnClick","equipWeapon","_kind","WeaponData","EVENT_SHOW_RELOAD_UI","shootInterval","shootdelay","reloadInterval","reloaddelay","clipnum","reloadAmo","gunSkinDataGroup","getItem","onBeginContact","contact","self","other","empty","item","groundItem","itemType","ItemType","weapon","EVENT_SHOW_GUN_UI","bC","_power","_isCrit","boom","onEndContact","_param","indexOf","_belongIndex","originPos","_isDef","curDef","def","str","desPos","randomNum","bezier","bezierTo","reduceHp","getChildByName","enabled","showToast","killNum","addKillNum","soundIndex","theParentC","gameRoot","ddd","allGunNode","getIndex","push","theRank","getPopup","showPopup","EVENT_SHOW_ALLROLENUM_UI"],"mappings":"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","sourceRoot":"/","sourcesContent":["import { SpeedType } from 'JoystickCommon'\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n\r\n        // from joystick\r\n        moveDir: {\r\n            default: cc.v2(1, 0),\r\n            displayName: 'Move Dir',\r\n            tooltip: '移动方向',\r\n        },\r\n        _speedType: {\r\n            default: SpeedType.STOP,\r\n            displayName: 'Speed Type',\r\n            type: SpeedType,\r\n            tooltip: '速度级别'\r\n        },\r\n\r\n        // from self\r\n        _moveSpeed: {\r\n            default: 0,\r\n            displayName: 'Move Speed',\r\n            tooltip: '移动速度'\r\n        },\r\n\r\n        stopSpeed: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            tooltip: '停止时速度'\r\n        },\r\n        // normalSpeed: {//暂时不用\r\n        //     default: 100,\r\n        //     type: cc.Integer,\r\n        //     tooltip: '正常速度'\r\n        // },\r\n        // fastSpeed: {//暂时不用\r\n        //     default: 200,\r\n        //     type: cc.Integer,\r\n        //     tooltip: '最快速度'\r\n        // },\r\n\r\n        roleAnim: {\r\n            default: null,\r\n            type: sp.Skeleton,\r\n            tooltip: '角色的Spine动画组件',\r\n        },\r\n        _gunDir: {\r\n            default: cc.v2(1, 0),\r\n        },\r\n        gunAnim: {\r\n            default: null,\r\n            type: sp.Skeleton,\r\n            tooltip: '枪的Spine动画组件',\r\n        },\r\n        gunNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '枪节点',\r\n        },\r\n        _haveGun: false,\r\n        gunData: {\r\n            default: {}\r\n        },\r\n        skinData: {\r\n            default: {}\r\n        },\r\n        _pbc: cc.PhysicsBoxCollider,\r\n        nameUI: cc.Label,\r\n        bulletPrefab: cc.Prefab,\r\n\r\n        tempGroundWeapon: null,\r\n\r\n        hpBar: cc.ProgressBar,\r\n        amoBar: cc.ProgressBar,\r\n\r\n        starNode: cc.Node,\r\n        lastHitBullet: null, //避免被火箭筒的爆炸范围或导弹头重复计算伤害\r\n        _isAim: false,//瞄准状态，此状态下枪不可自主转向，避免鬼畜\r\n        _aimTimer: 0,\r\n        _aimInterval: 0.05,\r\n        _stepTimer: 0,\r\n        _stepInterval: 0.3,\r\n        _isDie: false,\r\n        arrowNode: cc.Node,\r\n        _mapNoGun: false,\r\n        _isProtect: false,\r\n        _isGas: false,\r\n        _inGasTimer: 0,\r\n        _inGasInterval: 0.5,\r\n    },\r\n    onLoad() {\r\n        GameApp.eventManager.on(EventNames.EVENT_PLAYER_SHOOT, this.shoot.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_PLAYER_RELOAD, this.reload.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_PICKUP_WEAPON, this.pickUpWeapon.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_UPDATE_TOPBAR_SHOW, this.updatePlayerTopBarShow.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_AIM, this.aimState.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_THEGAMESTART, this.theGameStart.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_FLASH, this.doFlash.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_RESUME_HEALTH, this.doResumeHealth.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_UPDATE_STAR_SHOW, this.updateStarShow.bind(this))\r\n        this._pbc = this.getComponent(cc.PhysicsBoxCollider)\r\n        // console.log(this._pbc)\r\n        this._pbc.tag = Tags.player\r\n    },\r\n    onEnable() {\r\n\r\n    },\r\n    onDisable() {\r\n\r\n    },\r\n    onDestroy() {\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_PLAYER_SHOOT)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_PLAYER_RELOAD)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_PICKUP_WEAPON)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_UPDATE_TOPBAR_SHOW)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_AIM)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_THEGAMESTART)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_FLASH)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_RESUME_HEALTH)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_UPDATE_STAR_SHOW)\r\n\r\n    },\r\n    init() {\r\n        // this.schedule(() => {\r\n        //     console.log(GameApp.dataManager.userData.choosedSkinId)\r\n        //     GameApp.dataManager.setSkinId(GameApp.dataManager.userData.choosedSkinId += 1)\r\n        // }, 2);\r\n        if (GameApp.dataManager.globalData.isInGame) {\r\n            this.roleProtect()\r\n        }\r\n        this.skinData = GameApp.dataManager.jsonData.SkinsData[GameApp.dataManager.userData.choosedSkinId - 1]\r\n        this.initNameShow()\r\n        this.initSkinShow()\r\n\r\n    },\r\n    roleProtect() {\r\n        GameApp.audioManager.playEffect('noticeFindGun', 0.5)\r\n        if (!this._haveGun) {\r\n            this._isProtect = true\r\n            this.arrowNode.active = true\r\n        }\r\n        this.node.opacity = 100\r\n    },\r\n    theGameStart() {\r\n        this._isProtect = false\r\n        this.node.opacity = 255\r\n    },\r\n    doFlash() {\r\n        if (this._isDie) return;\r\n        this.move(null, true)\r\n    },\r\n    doResumeHealth() {\r\n        if (this._isDie) return;\r\n        this.resumeHealth(GameApp.dataManager.getResumeHealthNum())\r\n    },\r\n    resumeHealth(_num) {\r\n        this.node.runAction(cc.sequence(cc.callFunc(() => {\r\n            GameApp.uiManager.showGameObject(\"InfoLabel\", (node) => {\r\n                node.getComponent(cc.RichText).string = \"<b><color=green>+\" + _num + \"</color></b>\"\r\n                let init = cc.callFunc(() => {\r\n                    GameApp.dataManager.addHp(_num)\r\n                    node.setPosition(0, 110)\r\n                })\r\n                let seq = cc.sequence(init, cc.spawn(cc.fadeIn(0.2), cc.scaleTo(0, 1.5), cc.moveTo(0.3, cc.v2(0, 190))), cc.fadeOut(0.3), cc.callFunc(() => {\r\n                    node.destroy()\r\n                }))\r\n                node.runAction(seq)\r\n            }, this.node)\r\n        }), cc.delayTime(0.3)).repeat(4))\r\n    },\r\n    updateStarShow() {\r\n        var _sum = 0\r\n        for (var i = 0; i < 4; i++) {\r\n            _sum += GameApp.dataManager.globalData.getItemAttrArr[i].rank\r\n        }\r\n        if (_sum == 0) {\r\n            // console.log(\"没有星\")\r\n            this.starNode.active = false\r\n        } else {\r\n            var level = parseInt((_sum - 1) / 3)\r\n            var starNum = _sum - level * 3\r\n            // console.log(level)\r\n            // console.log(starNum)\r\n            this.starNode.children[0].getComponent(cc.Sprite).spriteFrame = GameApp.uiManager.commonAtlas.getSpriteFrame(\"level_bg_\" + (level + 1))\r\n            this.starNode.children[1].getComponent(cc.Sprite).spriteFrame = GameApp.uiManager.commonAtlas.getSpriteFrame(\"level_star_\" + (level + 1) + \"_\" + starNum)\r\n            this.starNode.active = true\r\n            // console.log(this.starNode)\r\n        }\r\n    },\r\n    initNameShow() {\r\n        this.nameUI.string = GameApp.dataManager.userData.playerName\r\n        // var colorIndex = Math.floor((this.skinData.skinid - 1) / 5)\r\n        // this.nameUI.node.color = new cc.Color().fromHEX(NameColor[colorIndex]);\r\n    },\r\n    initSkinShow() {\r\n        if (GameApp.dataManager.userData.choosedSkinId < 21) {\r\n            this.roleAnim.skeletonData = GameApp.uiManager.normalSkinData\r\n            this.roleAnim.setSkin(this.skinData.skinname)\r\n        } else {\r\n            this.roleAnim.skeletonData = GameApp.uiManager.advanceSkinDataGroup[GameApp.dataManager.userData.choosedSkinId - 21]\r\n        }\r\n        var arr = GameApp.dataManager.userData.choosedSkinId < 21 ? ['await'] : ['await_fight_1']\r\n        this.roleAnim.setAnimation(0, arr[0], true)\r\n    },\r\n    updatePlayerTopBarShow() {\r\n        this.hpBar.progress = GameApp.dataManager.globalData.curHp / GameApp.dataManager.globalData.maxHp\r\n        this.amoBar.progress = GameApp.dataManager.globalData.curAmoNum / GameApp.dataManager.globalData.maxAmoNum\r\n    },\r\n    // methods\r\n    move(dt, _flash) {\r\n        if (_flash) {\r\n            var _borderGroup = GameApp.uiManager.getGame(\"GameMap\").getComponent(\"GameMap\").enemySpawnPosGroupNode.children\r\n            // console.log(_borderGroup)\r\n            let newPos1 = this.node.position.add(this.moveDir.mul(1000));\r\n            if (newPos1.x < _borderGroup[0].x) {\r\n                newPos1.x = _borderGroup[0].x\r\n            }\r\n            if (newPos1.x > _borderGroup[1].x) {\r\n                newPos1.x = _borderGroup[1].x\r\n            }\r\n            if (newPos1.y > _borderGroup[0].y) {\r\n                newPos1.y = _borderGroup[0].y\r\n            }\r\n            if (newPos1.y < _borderGroup[2].y) {\r\n                newPos1.y = _borderGroup[2].y\r\n            }\r\n            this.node.setPosition(newPos1);\r\n            GameApp.audioManager.playEffect('flash')\r\n            return;\r\n        }\r\n        if (this._moveSpeed != 0) {\r\n            this._stepTimer -= dt;\r\n            if (this._stepTimer < 0) {\r\n                this._stepTimer = this._stepInterval\r\n                GameApp.audioManager.playEffect('run', 0.3)\r\n            }\r\n        }\r\n        var theAngle = 90 - cc.misc.radiansToDegrees(Math.atan2(this.moveDir.y, this.moveDir.x))\r\n        if (theAngle > 180 || theAngle < 0) {\r\n            this.roleAnim.node.scaleX = -1\r\n        } else {\r\n            this.roleAnim.node.scaleX = 1\r\n        }\r\n        let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed * dt));\r\n        this.node.setPosition(newPos);\r\n        GameApp.eventManager.emit(EventNames.EVENT_UPDATE_MIPMAP_PLAYER, cc.v2(this.node.x / 50, this.node.y / 50))\r\n        // this.roleAnim.node.setPosition(0, 0)\r\n    },\r\n    setSpeedType(_type) {\r\n        if (this._isDie) return;\r\n        if (this._speedType != _type) {\r\n            this._speedType = _type\r\n\r\n            var arr = GameApp.dataManager.userData.choosedSkinId < 21 ? ['await', 'run2', 'run2'] : ['await_fight_1', 'run', 'run']\r\n            this.roleAnim && this.roleAnim.setAnimation(0, arr[_type], true)\r\n        }\r\n    },\r\n    setDir(_dir) {\r\n        if (this._isDie) return;\r\n        this.moveDir = _dir\r\n        if (this._isAim) return;\r\n        this.setGunDir(_dir)\r\n    },\r\n    setGunDir(_dir) {\r\n        if (!this._haveGun) return\r\n        if (!this.gunNode) return\r\n        if (_dir == null) {\r\n            _dir = this.moveDir\r\n        }\r\n        this._gunDir = _dir\r\n        this.gunNode.rotation = -cc.misc.radiansToDegrees(\r\n            Math.atan2(_dir.y, _dir.x)\r\n        );\r\n        let theAngle = 90 - this.gunNode.rotation\r\n\r\n        if (theAngle > 180 || theAngle < 0) {\r\n            this.gunNode.scaleY = -1\r\n        } else {\r\n            this.gunNode.scaleY = 1\r\n        }\r\n    },\r\n    setArrowDir(_dir) {\r\n        this.arrowNode.setPosition(cc.v2(this.arrowNode.parent.position).add(_dir.mul(100)))\r\n        this.arrowNode.children[0].children[0].setPosition(cc.v2(this.arrowNode.children[0].position).add(_dir.mul(30)))\r\n        this.arrowNode.children[0].children[0].rotation = -cc.misc.radiansToDegrees(\r\n            Math.atan2(_dir.y, _dir.x)\r\n        );\r\n    },\r\n    update(dt) {\r\n        if (this._isDie) return;\r\n        if (GameApp.dataManager.globalData.isInGame) {\r\n            GameApp.dataManager.globalData.lifeTime += dt\r\n        }\r\n        switch (this._speedType) {\r\n            case SpeedType.STOP:\r\n                this._moveSpeed = this.stopSpeed;\r\n                break;\r\n            case SpeedType.NORMAL:\r\n                this._moveSpeed = GameApp.dataManager.globalData.curSpeed;\r\n                // this._moveSpeed = this.fastSpeed;\r\n                break;\r\n            case SpeedType.FAST:\r\n                this._moveSpeed = GameApp.dataManager.globalData.curSpeed + Math.floor(GameApp.dataManager.globalData.curSpeed * GameApp.dataManager.getEquipItemAttr(EquipType.speed));\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.move(dt);\r\n        this.checkGas(dt)\r\n        if (!this._haveGun && !this._mapNoGun) {\r\n            this._aimTimer -= dt\r\n            if (this._aimTimer < 0) {\r\n                this._aimTimer = this._aimInterval\r\n                this.arrowToNearestGun()\r\n            }\r\n        }\r\n\r\n        if (this._isProtect) return\r\n\r\n        if (this._isAim) {\r\n            this._aimTimer -= dt\r\n            if (this._aimTimer < 0) {\r\n                this._aimTimer = this._aimInterval\r\n                this.aimToNearest()\r\n            }\r\n        } else {\r\n            this._aimTimer = 0\r\n        }\r\n    },\r\n    lateUpdate(dt) {\r\n        // this.mainC.node.setPosition(this.player.position)\r\n        // this.testC.node.setPosition(this.player.position)\r\n        GameApp.uiManager.mapCamera.node.setPosition(this.node.position)\r\n        // this.mipmapCamera.node.setPosition(this.node.position)\r\n    },\r\n    checkGas(dt) {\r\n        if (GameApp.dataManager.globalData.gasConfig != null) {\r\n            let distance = cc.v2(GameApp.dataManager.globalData.gasConfig.safePosition).sub(cc.v2(this.node.position)).mag()\r\n            if (distance > GameApp.dataManager.globalData.gasConfig.gasCircle / 2) {\r\n                this._inGasTimer -= dt\r\n                if (this._inGasTimer < 0) {\r\n                    this._inGasTimer = this._inGasInterval\r\n                    this.beDamage(5, -1)\r\n                }\r\n                this._isGas = true\r\n            } else {\r\n                this._isGas = false\r\n            }\r\n        } else {\r\n            this._isGas = false\r\n        }\r\n    },\r\n    aimState(event) {\r\n        if (this._isDie) return;\r\n        if (!this._haveGun) return\r\n        this._isAim = event\r\n        if (this._isAim) {\r\n            this.aimToNearest()\r\n        }\r\n    },\r\n    aimToNearest() {\r\n        var allRoleArr = GameApp.dataManager.globalData.allRoleArr.concat()\r\n        // for (let i = 0; i < allRoleArr.length; i++) {\r\n        //     if (allRoleArr[i].skinData.skinid == this.skinData.skinid) {\r\n        //         allRoleArr.splice(i, 1)\r\n        //         break\r\n        //     }\r\n        // }\r\n        Tools.removeArray(allRoleArr, this.getComponent(\"Player\"))\r\n        var minDis = 1000000;\r\n        var index = -1;\r\n        for (let i = 0; i < allRoleArr.length; i++) {\r\n            // if (GameApp.uiManager.isInMapSight(allRoleArr[i].node)) {\r\n            var distance = cc.v2(allRoleArr[i].node.position).sub(cc.v2(this.node.position)).mag()\r\n            if (distance < minDis && distance < this.gunData.range * 1.4) {\r\n                minDis = distance\r\n                index = i\r\n            }\r\n            // }\r\n        }\r\n        var dir = null\r\n        if (index == -1) {\r\n            this._isAim = false\r\n        } else {\r\n            this._isAim = true\r\n            var aimEnemy = allRoleArr[index].node\r\n            dir = cc.v2(aimEnemy.position).sub(cc.v2(this.node.position)).normalize()\r\n        }\r\n        this.setGunDir(dir)\r\n    },\r\n    arrowToNearestGun() {\r\n        var allGunArr = GameApp.dataManager.globalData.allGunArr.concat()\r\n        var minDis = 1000000;\r\n        var index = -1;\r\n        for (let i = 0; i < allGunArr.length; i++) {\r\n            var distance = cc.v2(allGunArr[i].position).sub(cc.v2(this.node.position)).mag()\r\n            if (distance < minDis) {\r\n                minDis = distance\r\n                index = i\r\n            }\r\n        }\r\n        var dir = null\r\n        if (index == -1) {\r\n            this._mapNoGun = true\r\n            this.arrowNode.active = false\r\n        } else {\r\n            var aimGun = allGunArr[index]\r\n            dir = cc.v2(aimGun.position).sub(cc.v2(this.node.position)).normalize()\r\n            this.setArrowDir(dir)\r\n        }\r\n    },\r\n    shoot() {\r\n        if (this._isDie) return;\r\n        if (!this._haveGun) return\r\n        if (GameApp.dataManager.reduceAmo()) {\r\n\r\n            this.gunAnim.setAnimation(0, 'attack_' + this.gunData.skinname, false)\r\n            var power = Math.ceil(this.gunData.power * (GameApp.dataManager.globalData.curDamage + GameApp.dataManager.getEquipItemAttr(EquipType.damage)))\r\n            var isCrit = false\r\n            if (Tools.isCrit(GameApp.dataManager.globalData.curCrit + GameApp.dataManager.getEquipItemAttr(EquipType.crit))) {\r\n                power *= 2\r\n                isCrit = true\r\n            }\r\n            if (this.gunData.weaponid == 1002) {\r\n                GameApp.audioManager.playEffect('shot_shoot', 0.6)\r\n                var bullet1 = cc.instantiate(this.bulletPrefab)\r\n                var bullet2 = cc.instantiate(this.bulletPrefab)\r\n                var bullet3 = cc.instantiate(this.bulletPrefab)\r\n                let bulletPos = this.node.parent.parent.convertToNodeSpaceAR(this.gunNode.children[0].convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                bullet1.parent = bullet2.parent = bullet3.parent = this.node.parent.parent\r\n                bullet1.setPosition(bulletPos)\r\n                bullet2.setPosition(bulletPos)\r\n                bullet3.setPosition(bulletPos)\r\n                bullet1.rotation = this.gunNode.rotation\r\n                bullet2.rotation = this.gunNode.rotation + 30\r\n                bullet3.rotation = this.gunNode.rotation - 30\r\n                var cloneGunDir = cc.v2(this._gunDir)\r\n                var bulletC1 = bullet1.getComponent('Bullet')\r\n                bulletC1._belongTag = this._pbc.tag\r\n                bulletC1._belongName = GameApp.dataManager.userData.playerName\r\n                bulletC1._flyDir = cloneGunDir\r\n                bulletC1.init(this.gunData, power, isCrit)\r\n                var bulletC2 = bullet2.getComponent('Bullet')\r\n                bulletC2._belongTag = this._pbc.tag\r\n                bulletC2._belongName = GameApp.dataManager.userData.playerName\r\n                bulletC2._flyDir = cloneGunDir.rotate(-cc.misc.degreesToRadians(30))\r\n                bulletC2.init(this.gunData, power, isCrit)\r\n                var bulletC3 = bullet3.getComponent('Bullet')\r\n                bulletC3._belongTag = this._pbc.tag\r\n                bulletC3._belongName = GameApp.dataManager.userData.playerName\r\n                bulletC3._flyDir = cloneGunDir.rotate(-cc.misc.degreesToRadians(-30))\r\n                bulletC3.init(this.gunData, power, isCrit)\r\n            } else {\r\n                if (this.gunData.weaponid == 1003 || this.gunData.weaponid == 1103) {\r\n                    GameApp.audioManager.playEffect('charge_shoot', 0.6)\r\n                } else if (this.gunData.weaponid == 1005 || this.gunData.weaponid == 1105) {\r\n                    GameApp.audioManager.playEffect('missile_shoot', 0.6)\r\n                } else if (this.gunData.weaponid == 1102) {\r\n                    GameApp.audioManager.playEffect('shot_shoot', 0.6)\r\n                }\r\n                var bullet = cc.instantiate(this.bulletPrefab)\r\n                let bulletPos = this.node.parent.parent.convertToNodeSpaceAR(this.gunNode.children[0].convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                bullet.parent = this.node.parent.parent\r\n                bullet.setPosition(bulletPos)\r\n                bullet.rotation = this.gunNode.rotation\r\n                var bulletC = bullet.getComponent('Bullet')\r\n                bulletC._belongTag = this._pbc.tag\r\n                bulletC._belongName = GameApp.dataManager.userData.playerName\r\n                bulletC._flyDir = this._gunDir\r\n                bulletC.init(this.gunData, power, isCrit)\r\n            }\r\n            this.updatePlayerTopBarShow()\r\n        } else {\r\n            GameApp.uiManager.getUI(GameApp.uiManager.uiRoot.children[0].name).getComponent(GameApp.uiManager.uiRoot.children[0].name).reloadBtnClick()\r\n        }\r\n        if (GameApp.dataManager.globalData.curAmoNum == 0) {\r\n            GameApp.uiManager.getUI(GameApp.uiManager.uiRoot.children[0].name).getComponent(GameApp.uiManager.uiRoot.children[0].name).reloadBtnClick()\r\n        }\r\n    },\r\n    reload() {\r\n        if (this._isDie) return;\r\n        if (!this._haveGun) return\r\n        GameApp.audioManager.playEffect('reload', 0.6)\r\n        this.gunAnim.setAnimation(0, 'reload_' + this.gunData.skinname, false)\r\n    },\r\n    equipWeapon(_kind) {\r\n        GameApp.audioManager.playEffect('pick_item', 0.6)\r\n        this.gunData = GameApp.dataManager.jsonData.WeaponData[_kind]\r\n        this._haveGun = true\r\n        this.arrowNode.active = false\r\n        GameApp.eventManager.emit(EventNames.EVENT_SHOW_RELOAD_UI, true)\r\n        GameApp.dataManager.globalData.shootInterval = this.gunData.shootdelay\r\n        GameApp.dataManager.globalData.reloadInterval = this.gunData.reloaddelay\r\n        GameApp.dataManager.globalData.maxAmoNum = this.gunData.clipnum\r\n        GameApp.dataManager.reloadAmo()\r\n        this.gunNode.active = true\r\n        if (_kind < 3) {\r\n            this.gunAnim.skeletonData = GameApp.uiManager.gunSkinDataGroup[0]\r\n        } else {\r\n            this.gunAnim.skeletonData = GameApp.uiManager.gunSkinDataGroup[1]\r\n        }\r\n        this.gunAnim.setSkin(this.gunData.skinname)\r\n        this.setGunDir(this.moveDir)\r\n\r\n        // this.gunAnim.setAnimation(0, 'attack_' + this.gunData.skinname, false)\r\n    },\r\n    getItem() {\r\n\r\n    },\r\n    onBeginContact(contact, self, other) {\r\n        if (self.tag == Tags.empty) return;\r\n        if (other.tag == Tags.item) {\r\n            var groundItem = other.node.getComponent('GroundItem')\r\n            if (groundItem.itemType._type == ItemType.weapon) {\r\n                this.tempGroundWeapon = groundItem\r\n                if (!this._haveGun) {\r\n                    Tools.removeArray(GameApp.dataManager.globalData.allGunArr, other.node)\r\n                    this.pickUpWeapon()\r\n                } else {\r\n                    GameApp.eventManager.emit(EventNames.EVENT_SHOW_GUN_UI, true, GameApp.dataManager.jsonData.WeaponData[groundItem.itemType._kind])\r\n                }\r\n                // var _kind = groundItem.itemType._kind\r\n                // if (!this._haveGun) {\r\n                //     other.node.destroy()\r\n                // } else {\r\n                //     let _param = {\r\n                //         _type: ItemType.weapon,\r\n                //         _kind: GameApp.dataManager.jsonData.WeaponData.indexOf(this.gunData)\r\n                //     }\r\n                //     groundItem.init(_param)\r\n                // }\r\n                // this.equipWeapon(_kind)\r\n            } else if (groundItem.itemType._type == ItemType.item) {\r\n                this.getItem()\r\n            }\r\n        } else if (other.tag == Tags.bullet) {\r\n            if (!GameApp.dataManager.globalData.isInGame) return;\r\n            if (this._isDie) return\r\n            var bC = other.node.getComponent('Bullet')\r\n            if (bC._belongTag == self.tag) return\r\n            if (other.node == this.lastHitBullet) return;\r\n            this.lastHitBullet = other.node\r\n            this.beDamage(bC._power, bC._belongTag, bC._belongName, bC._isCrit)\r\n        } else if (other.tag == Tags.boom) {\r\n            if (this._isDie) return\r\n            this.beDamage(999, -2)\r\n        }\r\n    },\r\n    onEndContact(contact, self, other) {\r\n        if (self.tag == Tags.empty) return;\r\n        if (other.tag == Tags.item) {\r\n            var groundItem = other.node.getComponent('GroundItem')\r\n            if (groundItem.itemType._type == ItemType.weapon) {\r\n                // console.log(\"初始化\")\r\n                this.tempGroundWeapon = null\r\n                GameApp.eventManager.emit(EventNames.EVENT_SHOW_GUN_UI, false)\r\n            } else if (groundItem.itemType._type == ItemType.item) {\r\n\r\n            }\r\n        }\r\n    },\r\n\r\n    pickUpWeapon() {\r\n        var _kind = this.tempGroundWeapon.itemType._kind\r\n        if (!this._haveGun) {\r\n            this.tempGroundWeapon.node.destroy()\r\n        }\r\n        else {\r\n            let _param = {\r\n                _type: ItemType.weapon,\r\n                _kind: GameApp.dataManager.jsonData.WeaponData.indexOf(this.gunData)\r\n            }\r\n            this.tempGroundWeapon.init(_param)\r\n            GameApp.eventManager.emit(EventNames.EVENT_SHOW_GUN_UI, true, this.gunData)\r\n        }\r\n        this.equipWeapon(_kind)\r\n    },\r\n    beDamage(_power, _belongIndex, _belongName, _isCrit) {\r\n        GameApp.uiManager.showGameObject(\"InfoLabel\", (node) => {\r\n            var originPos = node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0.5, 0.5)))\r\n            node.setPosition(originPos)\r\n            //皮肤减伤+装备减伤\r\n            var _isDef = Math.ceil(_power * GameApp.dataManager.globalData.curDef) + Math.ceil(_power * GameApp.dataManager.getEquipItemAttr(EquipType.def))\r\n            _power -= _isDef\r\n            var str = \"<color=red>-\" + _power + \"</color>\"\r\n            if (_isCrit) {\r\n                str = \"<color=red>暴击-\" + _power + \"</color>\"\r\n            }\r\n            if (_isDef) {\r\n                str += \"<color=#0fffff>减伤\" + _isDef + \"</color>\"\r\n            }\r\n            node.getComponent(cc.RichText).string = \"<b>\" + str + \"</b>\"\r\n            let desPos = cc.v2(Tools.randomNum(60, 100), Tools.randomNum(60, 100))\r\n            let bezier = [originPos, cc.v2(originPos.x + desPos.x - 20, originPos.y + desPos.y + 20), originPos.add(desPos)];\r\n            let seq = cc.sequence(cc.spawn(cc.fadeIn(0.2), cc.scaleTo(0.3, 1.5), cc.bezierTo(0.3, bezier)), cc.delayTime(0.5), cc.fadeOut(0.3), cc.callFunc(() => {\r\n                node.destroy()\r\n            }))\r\n            node.runAction(seq)\r\n        }, this.node.parent.parent)\r\n        if (GameApp.dataManager.reduceHp(_power)) {\r\n            // console.log('收到子弹攻击')\r\n        } else {\r\n            // console.log('死掉了!!!!!!')\r\n            GameApp.audioManager.playEffect('maleDeath', 0.5)\r\n            this.node.parent = GameApp.uiManager.getGame(\"GameMap\").getChildByName(\"DeadObjectNode\")\r\n            this._pbc.enabled = false\r\n            this._isDie = true\r\n            if (_belongIndex == -1) {\r\n                GameApp.uiManager.showToast(GameApp.dataManager.userData.playerName + \" 被毒出局\")\r\n            } else if (_belongIndex == -2) {\r\n                GameApp.uiManager.showToast(GameApp.dataManager.userData.playerName + \" 被轰炸出局\")\r\n            } else {\r\n                var killNum = GameApp.dataManager.addKillNum(_belongIndex, _belongName)\r\n                if (killNum > 1) {\r\n                    var soundIndex = killNum > 5 ? 5 : killNum\r\n                    GameApp.audioManager.playEffect('kill' + soundIndex, 0.5)\r\n                    GameApp.uiManager.showToast(_belongName, null, killNum)\r\n                } else {\r\n                    GameApp.uiManager.showToast(_belongName + \" 击杀了 \" + GameApp.dataManager.userData.playerName)\r\n                }\r\n            }\r\n\r\n            // for (var i in GameApp.dataManager.globalData.allRoleArr) {\r\n            //     if (GameApp.dataManager.globalData.allRoleArr[i].skinData.skinid == this.skinData.skinid) {\r\n            //         GameApp.dataManager.globalData.allRoleArr.splice(i, 1)\r\n            //         break\r\n            //     }\r\n            // }\r\n            if (this._haveGun) {\r\n                var theParentC = GameApp.uiManager.gameRoot.children[0].getComponent(\"GameMap\")\r\n                GameApp.uiManager.showGameObject(\"GroundItem\", (node) => {\r\n                    let ddd = theParentC.allGunNode.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                    node.parent = theParentC.allGunNode\r\n                    node.setPosition(ddd)\r\n                    let _param = {\r\n                        _type: ItemType.weapon,\r\n                        _kind: Tools.getIndex(GameApp.dataManager.jsonData.WeaponData, this.gunData)\r\n                    }\r\n                    // console.log(_param._kind)\r\n                    node.getComponent('GroundItem').init(_param)\r\n                    GameApp.dataManager.globalData.allGunArr.push(node)\r\n                })\r\n            }\r\n            var arr = GameApp.dataManager.userData.choosedSkinId < 21 ? ['dead'] : ['dead2']\r\n            this.roleAnim.setAnimation(0, arr[0], false)\r\n            this.gunNode.active = false\r\n            Tools.removeArray(GameApp.dataManager.globalData.allRoleArr, this.node.getComponent('Player'))\r\n            var theRank = GameApp.dataManager.globalData.allRoleArr.length\r\n            GameApp.uiManager.getPopup(\"OverPopup\") == null && GameApp.uiManager.showPopup(\"OverPopup\", (node) => {\r\n                node.getComponent(\"OverPopup\").init(false, theRank + 1)\r\n            })\r\n            GameApp.eventManager.emit(EventNames.EVENT_SHOW_ALLROLENUM_UI)\r\n\r\n        }\r\n    }\r\n});\r\n"]}