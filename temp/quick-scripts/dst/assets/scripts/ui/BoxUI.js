
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui/BoxUI.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c5af8P64uBNMYGlZief5kOA', 'BoxUI');
// scripts/ui/BoxUI.js

"use strict";

var Utils = require("Utils");

cc.Class({
  "extends": cc.Component,
  properties: {
    coinUI: cc.Label,
    needCoinUI: cc.Label,
    box1CoinRewardUI: cc.Label,
    box2CoinRewardUI: cc.Label,
    onceClick: {
      "default": true,
      visible: false
    }
  },
  onLoad: function onLoad() {
    GameApp.eventManager.on(EventNames.EVENT_UPDATE_COIN_SHOW, this.updateUIShow.bind(this));
    this.updateUIShow();
  },
  onDestroy: function onDestroy() {
    GameApp.eventManager.removeListener(EventNames.EVENT_UPDATE_COIN_SHOW);
  },
  updateUIShow: function updateUIShow() {
    this.coinUI.string = GameApp.dataManager.userData.coinNum;
    this.needCoinUI.string = GameApp.dataManager.userData.box1NeedCoinNum;
    this.box1CoinRewardUI.string = GameApp.dataManager.userData.box1RewardCoinNum[0] + '~' + GameApp.dataManager.userData.box1RewardCoinNum[1];
    this.box2CoinRewardUI.string = GameApp.dataManager.userData.box2RewardCoinNum[0] + '~' + GameApp.dataManager.userData.box2RewardCoinNum[1];
  },
  oneBtnClick: function oneBtnClick() {
    var _this = this;

    if (!this.onceClick) return;
    this.onceClick = false;
    GameApp.audioManager.playEffect('click');

    if (GameApp.dataManager.reduceCoin(GameApp.dataManager.userData.box1NeedCoinNum)) {
      GameApp.uiManager.showPopup('OpenBoxPopup', function (node) {
        var getNum = Tools.randomNum(GameApp.dataManager.userData.box1RewardCoinNum[0], GameApp.dataManager.userData.box1RewardCoinNum[1]);
        GameApp.dataManager.addCoin(getNum);
        node.getComponent('OpenBoxPopup').init(GameApp.uiManager.boxSkinDataGroup[0], 1, getNum);

        if (GameApp.dataManager.userData.box1NeedCoinNum < 6400) {
          GameApp.dataManager.userData.box1NeedCoinNum *= 2;
          GameApp.dataManager.userData.box1RewardCoinNum[0] = GameApp.dataManager.userData.box1NeedCoinNum / 2;
          GameApp.dataManager.userData.box1RewardCoinNum[1] = GameApp.dataManager.userData.box1NeedCoinNum * 1.5;
        }

        _this.updateUIShow();

        _this.onceClick = true;
      });
    } else {
      this.onceClick = true;
      GameApp.uiManager.showToast("金币不足!");
    }
  },
  twoBtnClick: function twoBtnClick() {
    if (window.wx) {
      GameApp.uiManager.showToast("暂未开放！");
      return;
    }

    if (!this.onceClick) return;
    this.onceClick = false;
    GameApp.audioManager.playEffect('click');
    var self = this;

    if (window.tt) {
      Utils.addVideo("addVideo", function () {
        //看完了
        self.onceClick = true;
        GameApp.dataManager.addPlayedVideoNum();
        GameApp.uiManager.showPopup('OpenBoxPopup', function (node) {
          var getNum = Tools.randomNum(GameApp.dataManager.userData.box2RewardCoinNum[0], GameApp.dataManager.userData.box2RewardCoinNum[1]);
          GameApp.dataManager.addCoin(getNum);
          node.getComponent('OpenBoxPopup').init(GameApp.uiManager.boxSkinDataGroup[1], 1, getNum);

          if (GameApp.dataManager.userData.box2RewardCoinNum[0] < 1400) {
            GameApp.dataManager.userData.box2RewardCoinNum[0] = Math.floor(GameApp.dataManager.userData.box2RewardCoinNum[0] * 1.5);
            GameApp.dataManager.userData.box2RewardCoinNum[1] = Math.floor(GameApp.dataManager.userData.box2RewardCoinNum[1] * 1.5);
          }

          self.updateUIShow();
          self.onceClick = true;
        });
      }, function (_info) {
        //没看完
        self.onceClick = true;
        _info ? GameApp.uiManager.showToast(_info) : GameApp.uiManager.showToast("未看完视频！");
      });
    } else {
      self.onceClick = true;
      GameApp.dataManager.addPlayedVideoNum();
      GameApp.uiManager.showPopup('OpenBoxPopup', function (node) {
        var getNum = Tools.randomNum(GameApp.dataManager.userData.box2RewardCoinNum[0], GameApp.dataManager.userData.box2RewardCoinNum[1]);
        GameApp.dataManager.addCoin(getNum);
        node.getComponent('OpenBoxPopup').init(GameApp.uiManager.boxSkinDataGroup[1], 1, getNum);

        if (GameApp.dataManager.userData.box2RewardCoinNum[0] < 1400) {
          GameApp.dataManager.userData.box2RewardCoinNum[0] = Math.floor(GameApp.dataManager.userData.box2RewardCoinNum[0] * 1.5);
          GameApp.dataManager.userData.box2RewardCoinNum[1] = Math.floor(GameApp.dataManager.userData.box2RewardCoinNum[1] * 1.5);
        }

        self.updateUIShow();
        self.onceClick = true;
      });
    }
  },
  threeBtnClick: function threeBtnClick() {
    if (window.wx) {
      GameApp.uiManager.showToast("暂未开放！");
      return;
    }

    if (!this.onceClick) return;
    this.onceClick = false;
    GameApp.audioManager.playEffect('click');
    var self = this;

    if (window.tt) {
      Utils.addVideo("addVideo", function () {
        //看完了
        self.onceClick = true;
        GameApp.dataManager.addPlayedVideoNum();
        var getIndex = Tools.randomNum(26, 30);
        var getNum = 5;
        GameApp.dataManager.addPieceNum(getIndex, getNum);
        GameApp.uiManager.showPopup('OpenBoxPopup', function (node) {
          node.getComponent('OpenBoxPopup').init(GameApp.uiManager.boxSkinDataGroup[2], 2, getNum, getIndex);
          self.onceClick = true;
        });
      }, function (_info) {
        //没看完
        self.onceClick = true;
        _info ? GameApp.uiManager.showToast(_info) : GameApp.uiManager.showToast("未看完视频！");
      });
    } else {
      self.onceClick = true;
      GameApp.dataManager.addPlayedVideoNum();
      var getIndex = Tools.randomNum(26, 30);
      var getNum = 5;
      GameApp.dataManager.addPieceNum(getIndex, getNum);
      GameApp.uiManager.showPopup('OpenBoxPopup', function (node) {
        node.getComponent('OpenBoxPopup').init(GameApp.uiManager.boxSkinDataGroup[2], 2, getNum, getIndex);
        self.onceClick = true;
      });
    }
  },
  coinBtnClick: function coinBtnClick() {
    if (!this.onceClick) return;
    this.onceClick = false;
    GameApp.audioManager.playEffect('click');
    var self = this;

    if (window.tt) {
      Utils.addVideo("addVideo", function () {
        //看完了
        self.onceClick = true;
        GameApp.uiManager.showToast("获得500金币");
        GameApp.dataManager.addCoin(500);
        self.updateUIShow();
      }, function (_info) {
        //没看完
        self.onceClick = true;
        _info ? GameApp.uiManager.showToast(_info) : GameApp.uiManager.showToast("未看完视频！");
      });
    } else {
      self.onceClick = true;
      GameApp.uiManager.showToast("非真机,获得500金币");
      GameApp.dataManager.addCoin(500);
      self.updateUIShow();
    }
  },
  backBtnClick: function backBtnClick() {
    GameApp.audioManager.playEffect('click');
    GameApp.uiManager.showUI('LoginUI');
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlcXEJveFVJLmpzIl0sIm5hbWVzIjpbIlV0aWxzIiwicmVxdWlyZSIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiY29pblVJIiwiTGFiZWwiLCJuZWVkQ29pblVJIiwiYm94MUNvaW5SZXdhcmRVSSIsImJveDJDb2luUmV3YXJkVUkiLCJvbmNlQ2xpY2siLCJ2aXNpYmxlIiwib25Mb2FkIiwiR2FtZUFwcCIsImV2ZW50TWFuYWdlciIsIm9uIiwiRXZlbnROYW1lcyIsIkVWRU5UX1VQREFURV9DT0lOX1NIT1ciLCJ1cGRhdGVVSVNob3ciLCJiaW5kIiwib25EZXN0cm95IiwicmVtb3ZlTGlzdGVuZXIiLCJzdHJpbmciLCJkYXRhTWFuYWdlciIsInVzZXJEYXRhIiwiY29pbk51bSIsImJveDFOZWVkQ29pbk51bSIsImJveDFSZXdhcmRDb2luTnVtIiwiYm94MlJld2FyZENvaW5OdW0iLCJvbmVCdG5DbGljayIsImF1ZGlvTWFuYWdlciIsInBsYXlFZmZlY3QiLCJyZWR1Y2VDb2luIiwidWlNYW5hZ2VyIiwic2hvd1BvcHVwIiwibm9kZSIsImdldE51bSIsIlRvb2xzIiwicmFuZG9tTnVtIiwiYWRkQ29pbiIsImdldENvbXBvbmVudCIsImluaXQiLCJib3hTa2luRGF0YUdyb3VwIiwic2hvd1RvYXN0IiwidHdvQnRuQ2xpY2siLCJ3aW5kb3ciLCJ3eCIsInNlbGYiLCJ0dCIsImFkZFZpZGVvIiwiYWRkUGxheWVkVmlkZW9OdW0iLCJNYXRoIiwiZmxvb3IiLCJfaW5mbyIsInRocmVlQnRuQ2xpY2siLCJnZXRJbmRleCIsImFkZFBpZWNlTnVtIiwiY29pbkJ0bkNsaWNrIiwiYmFja0J0bkNsaWNrIiwic2hvd1VJIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBckI7O0FBRUFDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0ws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VW1DLEtBQVYsRUFBaUI7QUFBRTtBQUNsQk4sUUFBQUEsSUFBSSxDQUFDckMsU0FBTCxHQUFpQixJQUFqQjtBQUNBMkMsUUFBQUEsS0FBSyxHQUFHeEMsT0FBTyxDQUFDb0IsU0FBUixDQUFrQlUsU0FBbEIsQ0FBNEJVLEtBQTVCLENBQUgsR0FBd0N4QyxPQUFPLENBQUNvQixTQUFSLENBQWtCVSxTQUFsQixDQUE0QixRQUE1QixDQUE3QztBQUNILE9BUkQ7QUFTSCxLQVZELE1BVU87QUFDSEksTUFBQUEsSUFBSSxDQUFDckMsU0FBTCxHQUFpQixJQUFqQjtBQUNBRyxNQUFBQSxPQUFPLENBQUNvQixTQUFSLENBQWtCVSxTQUFsQixDQUE0QixhQUE1QjtBQUNBOUIsTUFBQUEsT0FBTyxDQUFDVSxXQUFSLENBQW9CZ0IsT0FBcEIsQ0FBNEIsR0FBNUI7QUFDQVEsTUFBQUEsSUFBSSxDQUFDN0IsWUFBTDtBQUNIO0FBRUosR0EzSkk7QUE0Skx3QyxFQUFBQSxZQTVKSywwQkE0SlU7QUFDWDdDLElBQUFBLE9BQU8sQ0FBQ2lCLFlBQVIsQ0FBcUJDLFVBQXJCLENBQWdDLE9BQWhDO0FBQ0FsQixJQUFBQSxPQUFPLENBQUNvQixTQUFSLENBQWtCMEIsTUFBbEIsQ0FBeUIsU0FBekI7QUFDSDtBQS9KSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVdGlscyA9IHJlcXVpcmUoXCJVdGlsc1wiKVxyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBjb2luVUk6IGNjLkxhYmVsLFxyXG4gICAgICAgIG5lZWRDb2luVUk6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJveDFDb2luUmV3YXJkVUk6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJveDJDb2luUmV3YXJkVUk6IGNjLkxhYmVsLFxyXG5cclxuICAgICAgICBvbmNlQ2xpY2s6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSxcclxuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIEdhbWVBcHAuZXZlbnRNYW5hZ2VyLm9uKEV2ZW50TmFtZXMuRVZFTlRfVVBEQVRFX0NPSU5fU0hPVywgdGhpcy51cGRhdGVVSVNob3cuYmluZCh0aGlzKSlcclxuICAgICAgICB0aGlzLnVwZGF0ZVVJU2hvdygpXHJcbiAgICB9LFxyXG4gICAgb25EZXN0cm95KCkge1xyXG4gICAgICAgIEdhbWVBcHAuZXZlbnRNYW5hZ2VyLnJlbW92ZUxpc3RlbmVyKEV2ZW50TmFtZXMuRVZFTlRfVVBEQVRFX0NPSU5fU0hPVylcclxuICAgIH0sXHJcbiAgICB1cGRhdGVVSVNob3coKSB7XHJcbiAgICAgICAgdGhpcy5jb2luVUkuc3RyaW5nID0gR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5jb2luTnVtXHJcbiAgICAgICAgdGhpcy5uZWVkQ29pblVJLnN0cmluZyA9IEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MU5lZWRDb2luTnVtXHJcbiAgICAgICAgdGhpcy5ib3gxQ29pblJld2FyZFVJLnN0cmluZyA9IEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MVJld2FyZENvaW5OdW1bMF0gKyAnficgKyBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFSZXdhcmRDb2luTnVtWzFdXHJcbiAgICAgICAgdGhpcy5ib3gyQ29pblJld2FyZFVJLnN0cmluZyA9IEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MlJld2FyZENvaW5OdW1bMF0gKyAnficgKyBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDJSZXdhcmRDb2luTnVtWzFdXHJcbiAgICB9LFxyXG4gICAgb25lQnRuQ2xpY2soKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLm9uY2VDbGljaykgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMub25jZUNsaWNrID0gZmFsc2VcclxuICAgICAgICBHYW1lQXBwLmF1ZGlvTWFuYWdlci5wbGF5RWZmZWN0KCdjbGljaycpXHJcbiAgICAgICAgaWYgKEdhbWVBcHAuZGF0YU1hbmFnZXIucmVkdWNlQ29pbihHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFOZWVkQ29pbk51bSkpIHtcclxuICAgICAgICAgICAgR2FtZUFwcC51aU1hbmFnZXIuc2hvd1BvcHVwKCdPcGVuQm94UG9wdXAnLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmFyIGdldE51bSA9IFRvb2xzLnJhbmRvbU51bShHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFSZXdhcmRDb2luTnVtWzBdLCBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFSZXdhcmRDb2luTnVtWzFdKVxyXG4gICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci5hZGRDb2luKGdldE51bSlcclxuICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KCdPcGVuQm94UG9wdXAnKS5pbml0KEdhbWVBcHAudWlNYW5hZ2VyLmJveFNraW5EYXRhR3JvdXBbMF0sIDEsIGdldE51bSlcclxuICAgICAgICAgICAgICAgIGlmIChHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFOZWVkQ29pbk51bSA8IDY0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFOZWVkQ29pbk51bSAqPSAyXHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gxUmV3YXJkQ29pbk51bVswXSA9IEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MU5lZWRDb2luTnVtIC8gMlxyXG4gICAgICAgICAgICAgICAgICAgIEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MVJld2FyZENvaW5OdW1bMV0gPSBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDFOZWVkQ29pbk51bSAqIDEuNVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVVSVNob3coKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlQ2xpY2sgPSB0cnVlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5vbmNlQ2xpY2sgPSB0cnVlXHJcbiAgICAgICAgICAgIEdhbWVBcHAudWlNYW5hZ2VyLnNob3dUb2FzdChcIumHkeW4geS4jei2syFcIilcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdHdvQnRuQ2xpY2soKSB7XHJcbiAgICAgICAgaWYgKHdpbmRvdy53eCkge1xyXG4gICAgICAgICAgICBHYW1lQXBwLnVpTWFuYWdlci5zaG93VG9hc3QoXCLmmoLmnKrlvIDmlL7vvIFcIilcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5vbmNlQ2xpY2spIHJldHVybjtcclxuICAgICAgICB0aGlzLm9uY2VDbGljayA9IGZhbHNlXHJcbiAgICAgICAgR2FtZUFwcC5hdWRpb01hbmFnZXIucGxheUVmZmVjdCgnY2xpY2snKVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgICAgIGlmICh3aW5kb3cudHQpIHtcclxuICAgICAgICAgICAgVXRpbHMuYWRkVmlkZW8oXCJhZGRWaWRlb1wiLCBmdW5jdGlvbiAoKSB7IC8v55yL5a6M5LqGXHJcbiAgICAgICAgICAgICAgICBzZWxmLm9uY2VDbGljayA9IHRydWVcclxuICAgICAgICAgICAgICAgIEdhbWVBcHAuZGF0YU1hbmFnZXIuYWRkUGxheWVkVmlkZW9OdW0oKVxyXG4gICAgICAgICAgICAgICAgR2FtZUFwcC51aU1hbmFnZXIuc2hvd1BvcHVwKCdPcGVuQm94UG9wdXAnLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnZXROdW0gPSBUb29scy5yYW5kb21OdW0oR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVswXSwgR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVsxXSlcclxuICAgICAgICAgICAgICAgICAgICBHYW1lQXBwLmRhdGFNYW5hZ2VyLmFkZENvaW4oZ2V0TnVtKVxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KCdPcGVuQm94UG9wdXAnKS5pbml0KEdhbWVBcHAudWlNYW5hZ2VyLmJveFNraW5EYXRhR3JvdXBbMV0sIDEsIGdldE51bSlcclxuICAgICAgICAgICAgICAgICAgICBpZiAoR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVswXSA8IDE0MDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVswXSA9IE1hdGguZmxvb3IoR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVswXSAqIDEuNSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVsxXSA9IE1hdGguZmxvb3IoR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVsxXSAqIDEuNSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGVVSVNob3coKVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKF9pbmZvKSB7IC8v5rKh55yL5a6MXHJcbiAgICAgICAgICAgICAgICBzZWxmLm9uY2VDbGljayA9IHRydWVcclxuICAgICAgICAgICAgICAgIF9pbmZvID8gR2FtZUFwcC51aU1hbmFnZXIuc2hvd1RvYXN0KF9pbmZvKSA6IEdhbWVBcHAudWlNYW5hZ2VyLnNob3dUb2FzdChcIuacqueci+WujOinhumike+8gVwiKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICBHYW1lQXBwLmRhdGFNYW5hZ2VyLmFkZFBsYXllZFZpZGVvTnVtKClcclxuICAgICAgICAgICAgR2FtZUFwcC51aU1hbmFnZXIuc2hvd1BvcHVwKCdPcGVuQm94UG9wdXAnLCAobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmFyIGdldE51bSA9IFRvb2xzLnJhbmRvbU51bShHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDJSZXdhcmRDb2luTnVtWzBdLCBHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDJSZXdhcmRDb2luTnVtWzFdKVxyXG4gICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci5hZGRDb2luKGdldE51bSlcclxuICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KCdPcGVuQm94UG9wdXAnKS5pbml0KEdhbWVBcHAudWlNYW5hZ2VyLmJveFNraW5EYXRhR3JvdXBbMV0sIDEsIGdldE51bSlcclxuICAgICAgICAgICAgICAgIGlmIChHYW1lQXBwLmRhdGFNYW5hZ2VyLnVzZXJEYXRhLmJveDJSZXdhcmRDb2luTnVtWzBdIDwgMTQwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MlJld2FyZENvaW5OdW1bMF0gPSBNYXRoLmZsb29yKEdhbWVBcHAuZGF0YU1hbmFnZXIudXNlckRhdGEuYm94MlJld2FyZENvaW5OdW1bMF0gKiAxLjUpXHJcbiAgICAgICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVsxXSA9IE1hdGguZmxvb3IoR2FtZUFwcC5kYXRhTWFuYWdlci51c2VyRGF0YS5ib3gyUmV3YXJkQ29pbk51bVsxXSAqIDEuNSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlVUlTaG93KClcclxuICAgICAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB0aHJlZUJ0bkNsaWNrKCkge1xyXG4gICAgICAgIGlmICh3aW5kb3cud3gpIHtcclxuICAgICAgICAgICAgR2FtZUFwcC51aU1hbmFnZXIuc2hvd1RvYXN0KFwi5pqC5pyq5byA5pS+77yBXCIpXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMub25jZUNsaWNrKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5vbmNlQ2xpY2sgPSBmYWxzZVxyXG4gICAgICAgIEdhbWVBcHAuYXVkaW9NYW5hZ2VyLnBsYXlFZmZlY3QoJ2NsaWNrJylcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXNcclxuXHJcbiAgICAgICAgaWYgKHdpbmRvdy50dCkge1xyXG4gICAgICAgICAgICBVdGlscy5hZGRWaWRlbyhcImFkZFZpZGVvXCIsIGZ1bmN0aW9uICgpIHsgLy/nnIvlrozkuoZcclxuICAgICAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci5hZGRQbGF5ZWRWaWRlb051bSgpXHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0SW5kZXggPSBUb29scy5yYW5kb21OdW0oMjYsIDMwKVxyXG4gICAgICAgICAgICAgICAgdmFyIGdldE51bSA9IDVcclxuICAgICAgICAgICAgICAgIEdhbWVBcHAuZGF0YU1hbmFnZXIuYWRkUGllY2VOdW0oZ2V0SW5kZXgsIGdldE51bSlcclxuICAgICAgICAgICAgICAgIEdhbWVBcHAudWlNYW5hZ2VyLnNob3dQb3B1cCgnT3BlbkJveFBvcHVwJywgKG5vZGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmdldENvbXBvbmVudCgnT3BlbkJveFBvcHVwJykuaW5pdChHYW1lQXBwLnVpTWFuYWdlci5ib3hTa2luRGF0YUdyb3VwWzJdLCAyLCBnZXROdW0sIGdldEluZGV4KVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKF9pbmZvKSB7IC8v5rKh55yL5a6MXHJcbiAgICAgICAgICAgICAgICBzZWxmLm9uY2VDbGljayA9IHRydWVcclxuICAgICAgICAgICAgICAgIF9pbmZvID8gR2FtZUFwcC51aU1hbmFnZXIuc2hvd1RvYXN0KF9pbmZvKSA6IEdhbWVBcHAudWlNYW5hZ2VyLnNob3dUb2FzdChcIuacqueci+WujOinhumike+8gVwiKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYub25jZUNsaWNrID0gdHJ1ZVxyXG4gICAgICAgICAgICBHYW1lQXBwLmRhdGFNYW5hZ2VyLmFkZFBsYXllZFZpZGVvTnVtKClcclxuICAgICAgICAgICAgdmFyIGdldEluZGV4ID0gVG9vbHMucmFuZG9tTnVtKDI2LCAzMClcclxuICAgICAgICAgICAgdmFyIGdldE51bSA9IDVcclxuICAgICAgICAgICAgR2FtZUFwcC5kYXRhTWFuYWdlci5hZGRQaWVjZU51bShnZXRJbmRleCwgZ2V0TnVtKVxyXG4gICAgICAgICAgICBHYW1lQXBwLnVpTWFuYWdlci5zaG93UG9wdXAoJ09wZW5Cb3hQb3B1cCcsIChub2RlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBub2RlLmdldENvbXBvbmVudCgnT3BlbkJveFBvcHVwJykuaW5pdChHYW1lQXBwLnVpTWFuYWdlci5ib3hTa2luRGF0YUdyb3VwWzJdLCAyLCBnZXROdW0sIGdldEluZGV4KVxyXG4gICAgICAgICAgICAgICAgc2VsZi5vbmNlQ2xpY2sgPSB0cnVlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29pbkJ0bkNsaWNrKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5vbmNlQ2xpY2spIHJldHVybjtcclxuICAgICAgICB0aGlzLm9uY2VDbGljayA9IGZhbHNlXHJcbiAgICAgICAgR2FtZUFwcC5hdWRpb01hbmFnZXIucGxheUVmZmVjdCgnY2xpY2snKVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpc1xyXG5cclxuICAgICAgICBpZiAod2luZG93LnR0KSB7XHJcbiAgICAgICAgICAgIFV0aWxzLmFkZFZpZGVvKFwiYWRkVmlkZW9cIiwgZnVuY3Rpb24gKCkgeyAvL+eci+WujOS6hlxyXG4gICAgICAgICAgICAgICAgc2VsZi5vbmNlQ2xpY2sgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICBHYW1lQXBwLnVpTWFuYWdlci5zaG93VG9hc3QoXCLojrflvpc1MDDph5HluIFcIilcclxuICAgICAgICAgICAgICAgIEdhbWVBcHAuZGF0YU1hbmFnZXIuYWRkQ29pbig1MDApXHJcbiAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZVVJU2hvdygpXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChfaW5mbykgeyAvL+ayoeeci+WujFxyXG4gICAgICAgICAgICAgICAgc2VsZi5vbmNlQ2xpY2sgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICBfaW5mbyA/IEdhbWVBcHAudWlNYW5hZ2VyLnNob3dUb2FzdChfaW5mbykgOiBHYW1lQXBwLnVpTWFuYWdlci5zaG93VG9hc3QoXCLmnKrnnIvlrozop4bpopHvvIFcIilcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLm9uY2VDbGljayA9IHRydWVcclxuICAgICAgICAgICAgR2FtZUFwcC51aU1hbmFnZXIuc2hvd1RvYXN0KFwi6Z2e55yf5py6LOiOt+W+lzUwMOmHkeW4gVwiKVxyXG4gICAgICAgICAgICBHYW1lQXBwLmRhdGFNYW5hZ2VyLmFkZENvaW4oNTAwKVxyXG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVVJU2hvdygpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbiAgICBiYWNrQnRuQ2xpY2soKSB7XHJcbiAgICAgICAgR2FtZUFwcC5hdWRpb01hbmFnZXIucGxheUVmZmVjdCgnY2xpY2snKVxyXG4gICAgICAgIEdhbWVBcHAudWlNYW5hZ2VyLnNob3dVSSgnTG9naW5VSScpXHJcbiAgICB9LFxyXG59KTtcclxuIl19