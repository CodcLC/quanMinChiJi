{"version":3,"sources":["assets\\scripts\\game\\Enemy.js"],"names":["cc","Class","Component","properties","moveDir","v2","displayName","tooltip","_speedType","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","normalSpeed","fastSpeed","roleAnim","sp","Skeleton","_gunDir","gunAnim","gunNode","Node","_haveGun","_mapNoGun","_mapNoBox","thisName","gunData","skinData","_pbc","PhysicsBoxCollider","nameUI","Label","bulletPrefab","Prefab","_choosedSkinId","hpBar","ProgressBar","amoBar","starNode","_maxHp","_curHp","_shootInterval","_reloadInterval","_maxAmoNum","_curAmoNum","_curDamage","_curCrit","_curSpeed","_curCd","_curDef","_curRecovery","getItemAttrArr","equipItemAttr","_shootFlag","_shootTimer","_reloadFlag","_reloadTimer","lastHitBullet","_desTime","_desTime2","_isAim","_aimDir","_aimTimer","_aimInterval","_isDie","_move","_isProtect","_isBlock","_isGas","_inGasTimer","_inGasInterval","onLoad","rank","item","GameApp","eventManager","on","EventNames","EVENT_THEGAMESTART","theGameStart","bind","EVENT_NOTIFY_ENEMY_MAPBOX","notifyMapBox","getComponent","onEnable","onDisable","onDestroy","removeListener","init","_index","_names","dataManager","globalData","isInGame","roleProtect","jsonData","SkinsData","addSkinAttr","initNameShow","initSkinShow","setSpeedType","FAST","curSkinData","userData","baseHp","Math","floor","att_hpmax","baseDamage","att_damage","baseCrit","att_crit","baseSpeed","att_speed","baseCd","att_cd","baseDef","att_defense","baseRecovery","att_recovery","node","opacity","enemyEquipBoxItem","arr","_selectIndex","Tools","removeArray","length","getRandomElement","_rank","ItemAttr","attr","updateStarShow","_sum","i","active","level","parseInt","starNum","children","Sprite","spriteFrame","uiManager","commonAtlas","getSpriteFrame","string","skeletonData","normalSkinData","setSkin","skinname","advanceSkinDataGroup","setAnimation","move","dt","theAngle","misc","radiansToDegrees","atan2","y","x","scaleX","newPos","position","add","mul","setPosition","doParser","setDir","rotate","gasConfig","dir","safePosition","sub","distance","mag","gasCircle","beDamage","normalize","searchGun","searchBox","randomNum","desDir","allGunArr","concat","minDis","index","dirDistance","aimGun","allBoxArr","aimBox","_type","_dir","setGunDir","rotation","scaleY","update","NORMAL","EquipType","speed","aimToNearest","shoot","reloadAmo","lateUpdate","range","allRoleArr","aimEnemy","reduceAmo","power","ceil","damage","isCrit","crit","weaponid","isInMapSight","audioManager","playEffect","bullet1","instantiate","bullet2","bullet3","bulletPos","parent","convertToNodeSpaceAR","convertToWorldSpaceAR","cloneGunDir","bulletC1","_belongTag","tag","_belongName","_flyDir","bulletC2","degreesToRadians","bulletC3","bullet","bulletC","updateAmoShow","reload","a","progress","updateHpShow","equipWeapon","_kind","WeaponData","shootdelay","reloaddelay","clipnum","gunSkinDataGroup","getItem","onBeginContact","contact","self","other","Tags","empty","groundItem","itemType","ItemType","weapon","destroy","bC","_power","_isCrit","collider","rotateSelf","scheduleOnce","boom","reduceHp","_num","_belongIndex","_weaponid","showGameObject","originPos","_isDef","def","str","RichText","desPos","bezier","seq","sequence","spawn","fadeIn","scaleTo","bezierTo","delayTime","fadeOut","callFunc","runAction","getGame","getChildByName","enabled","showToast","killNum","addKillNum","playerName","soundIndex","log","addActivityNum","theParentC","gameRoot","ddd","allGunNode","_param","getIndex","push","stopActionByTag","emit","EVENT_SHOW_ALLROLENUM_UI"],"mappings":"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","sourceRoot":"/","sourcesContent":["import { SpeedType } from 'JoystickCommon'\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n\r\n        // from joystick\r\n        moveDir: {\r\n            default: cc.v2(0, 0),\r\n            displayName: 'Move Dir',\r\n            tooltip: '移动方向',\r\n        },\r\n        _speedType: {\r\n            default: SpeedType.STOP,\r\n            displayName: 'Speed Type',\r\n            type: SpeedType,\r\n            tooltip: '速度级别'\r\n        },\r\n\r\n        // from self\r\n        _moveSpeed: {\r\n            default: 0,\r\n            displayName: 'Move Speed',\r\n            tooltip: '移动速度'\r\n        },\r\n\r\n        stopSpeed: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            tooltip: '停止时速度'\r\n        },\r\n        normalSpeed: {\r\n            default: 200,\r\n            type: cc.Integer,\r\n            tooltip: '正常速度'\r\n        },\r\n        fastSpeed: {\r\n            default: 200,\r\n            type: cc.Integer,\r\n            tooltip: '最快速度'\r\n        },\r\n\r\n        roleAnim: {\r\n            default: null,\r\n            type: sp.Skeleton,\r\n            tooltip: '角色的Spine动画组件',\r\n        },\r\n        _gunDir: {\r\n            default: cc.v2(1, 0),\r\n        },\r\n        gunAnim: {\r\n            default: null,\r\n            type: sp.Skeleton,\r\n            tooltip: '枪的Spine动画组件',\r\n        },\r\n        gunNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '枪节点',\r\n        },\r\n        _haveGun: false,\r\n        _mapNoGun: false,\r\n        _mapNoBox: true,\r\n        thisName: \"\",\r\n        gunData: {\r\n            default: {}\r\n        },\r\n        skinData: {\r\n            default: {}\r\n        },\r\n        _pbc: cc.PhysicsBoxCollider,\r\n        nameUI: cc.Label,\r\n        bulletPrefab: cc.Prefab,\r\n\r\n        _choosedSkinId: 0,\r\n\r\n        hpBar: cc.ProgressBar,\r\n        amoBar: cc.ProgressBar,\r\n\r\n        starNode: cc.Node,\r\n        _maxHp: 100,\r\n        _curHp: 100,\r\n        _shootInterval: 0,\r\n        _reloadInterval: 0,\r\n        _maxAmoNum: 20,\r\n        _curAmoNum: 20,\r\n\r\n        _curDamage: 0,\r\n        _curCrit: 0,\r\n        _curSpeed: 200,\r\n        _curCd: 0,\r\n        _curDef: 0,\r\n        _curRecovery: 0,\r\n\r\n        getItemAttrArr: [],//伤害，防御，移速，暴击\r\n        equipItemAttr: [],//(装备带来的属性)伤害，防御，移速，暴击\r\n\r\n\r\n        _shootFlag: false,\r\n        _shootTimer: 0.3,\r\n        _reloadFlag: false,\r\n        _reloadTimer: 0,\r\n        lastHitBullet: null,\r\n\r\n        _desTime: 0,//巡逻的变向频率\r\n        _desTime2: 0,// 追踪或逃跑的变向频率\r\n        _isAim: false,//瞄准状态，此状态下枪不可自主转向，避免鬼畜\r\n        _aimDir: null,\r\n        _aimTimer: 0,\r\n        _aimInterval: 0.1,\r\n        _isDie: false,\r\n        _move: false,\r\n        _isProtect: false,\r\n        _isBlock: false,\r\n        _isGas: false,\r\n        _inGasTimer: 0,\r\n        _inGasInterval: 0.5,\r\n    },\r\n    onLoad() {\r\n        this.getItemAttrArr = [{\r\n            rank: 0,\r\n            item: null\r\n        }, {\r\n            rank: 0,\r\n            item: null\r\n        }, {\r\n            rank: 0,\r\n            item: null\r\n        }, {\r\n            rank: 0,\r\n            item: null\r\n        }]//伤害，防御，移速，暴击\r\n        this.equipItemAttr = [0, 0, 0, 0]//(装备带来的属性)伤害，防御，移速，暴击\r\n\r\n        GameApp.eventManager.on(EventNames.EVENT_THEGAMESTART, this.theGameStart.bind(this))\r\n        GameApp.eventManager.on(EventNames.EVENT_NOTIFY_ENEMY_MAPBOX, this.notifyMapBox.bind(this))\r\n        // this._pbc = this.getComponent(cc.PhysicsBoxCollider)\r\n        // this._pbc.tag = Tags.role\r\n        this._pbc = this.getComponent(cc.PhysicsBoxCollider)\r\n        // this._desTime = Tools.randomNum(1, 3)\r\n    },\r\n    onEnable() {\r\n\r\n    },\r\n    onDisable() {\r\n    },\r\n    onDestroy() {\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_THEGAMESTART)\r\n        GameApp.eventManager.removeListener(EventNames.EVENT_NOTIFY_ENEMY_MAPBOX)\r\n    },\r\n    init(_index, _names) {\r\n        // this.schedule(() => {\r\n        //     console.log(GameApp.dataManager.userData.choosedSkinId)\r\n        //     GameApp.dataManager.setSkinId(GameApp.dataManager.userData.choosedSkinId += 1)\r\n        // }, 2);\r\n        if (GameApp.dataManager.globalData.isInGame) {\r\n            this.roleProtect()\r\n        }\r\n        this._choosedSkinId = _index\r\n        this.skinData = GameApp.dataManager.jsonData.SkinsData[_index - 1]\r\n        this.addSkinAttr()\r\n        this.initNameShow(_names)\r\n        this.initSkinShow()\r\n        this.setSpeedType(SpeedType.FAST)\r\n        // console.log(this._pbc.tag)\r\n    },\r\n    addSkinAttr() {\r\n        var curSkinData = this.skinData\r\n        this._maxHp = this._curHp = GameApp.dataManager.userData.baseHp + Math.floor(GameApp.dataManager.userData.baseHp * (curSkinData.att_hpmax / 100))\r\n        this._curDamage = GameApp.dataManager.userData.baseDamage + curSkinData.att_damage / 100\r\n        this._curCrit = GameApp.dataManager.userData.baseCrit + curSkinData.att_crit / 10\r\n        this._curSpeed = GameApp.dataManager.userData.baseSpeed + Math.floor(GameApp.dataManager.userData.baseSpeed * (curSkinData.att_speed / 100))\r\n        this._curCd = GameApp.dataManager.userData.baseCd + curSkinData.att_cd / 100\r\n        this._curDef = GameApp.dataManager.userData.baseDef + curSkinData.att_defense / 100\r\n        this._curRecovery = GameApp.dataManager.userData.baseRecovery + curSkinData.att_recovery / 100\r\n    },\r\n    roleProtect() {\r\n        this._isProtect = true\r\n        this.node.opacity = 0\r\n    },\r\n    theGameStart() {\r\n        this.node.opacity = 255\r\n        this._isProtect = false\r\n    },\r\n    notifyMapBox() {\r\n        this._mapNoBox = false\r\n    },\r\n    enemyEquipBoxItem() {\r\n        var arr = [0, 1, 2, 3]\r\n        var _selectIndex = 0\r\n        while (this.getItemAttrArr[_selectIndex].rank == 3) {\r\n            Tools.removeArray(arr, _selectIndex)\r\n            if (arr.length == 0) {\r\n                return\r\n            }\r\n            _selectIndex = Tools.getRandomElement(arr)\r\n        }\r\n\r\n        // console.log(\"选择了\" + _selectIndex)\r\n        var _rank = this.getItemAttrArr[_selectIndex].rank + 1\r\n        this.getItemAttrArr[_selectIndex] = {\r\n            rank: _rank,\r\n            item: ItemAttr[_selectIndex][_rank - 1]\r\n        }\r\n        this.equipItemAttr[_selectIndex] = this.getItemAttrArr[_selectIndex].item.attr\r\n        this.updateStarShow()\r\n    },\r\n    updateStarShow() {\r\n        var _sum = 0\r\n        for (var i = 0; i < 4; i++) {\r\n            _sum += this.getItemAttrArr[i].rank\r\n        }\r\n        if (_sum == 0) {\r\n            this.starNode.active = false\r\n        } else {\r\n            var level = parseInt((_sum - 1) / 3)\r\n            var starNum = _sum - level * 3\r\n            this.starNode.children[0].getComponent(cc.Sprite).spriteFrame = GameApp.uiManager.commonAtlas.getSpriteFrame(\"level_bg_\" + (level + 1))\r\n            this.starNode.children[1].getComponent(cc.Sprite).spriteFrame = GameApp.uiManager.commonAtlas.getSpriteFrame(\"level_star_\" + (level + 1) + \"_\" + starNum)\r\n            this.starNode.active = true\r\n        }\r\n    },\r\n    initNameShow(_names) {\r\n        this.thisName = _names\r\n        this.nameUI.string = _names\r\n        if (!GameApp.dataManager.globalData.isInGame) {\r\n            this.hpBar.node.active = false\r\n        }\r\n        // var colorIndex = Math.floor((this.skinData.skinid - 1) / 5)\r\n        // this.nameUI.node.color = new cc.Color().fromHEX(NameColor[colorIndex]);\r\n    },\r\n    initSkinShow() {\r\n        if (this._choosedSkinId < 21) {\r\n            this.roleAnim.skeletonData = GameApp.uiManager.normalSkinData\r\n            this.roleAnim.setSkin(this.skinData.skinname)\r\n        } else {\r\n            this.roleAnim.skeletonData = GameApp.uiManager.advanceSkinDataGroup[this._choosedSkinId - 21]\r\n        }\r\n        var arr = this._choosedSkinId < 21 ? ['await'] : ['await_fight_1']\r\n        this.roleAnim.setAnimation(0, arr[0], true)\r\n    },\r\n    // methods\r\n    move(dt) {\r\n        // this.node.rotation = 90 - cc.misc.radiansToDegrees(\r\n        //     Math.atan2(this.moveDir.y, this.moveDir.x)\r\n        // );\r\n        if (!this.moveDir) return\r\n        var theAngle = 90 - cc.misc.radiansToDegrees(Math.atan2(this.moveDir.y, this.moveDir.x))\r\n        if (theAngle > 180 || theAngle < 0) {\r\n            this.roleAnim.node.scaleX = -1\r\n        } else {\r\n            this.roleAnim.node.scaleX = 1\r\n        }\r\n        let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed * dt));\r\n        this.node.setPosition(newPos);\r\n        // this.roleAnim.node.setPosition(0, 0)\r\n    },\r\n    doParser(dt) {\r\n        this._desTime -= dt\r\n        this._desTime2 -= dt\r\n        if (this._isAim) {\r\n            if (this._desTime2 < 0) {\r\n                this._desTime2 = 1\r\n                if (this._haveGun) {\r\n                    // console.log(\"追踪\")\r\n                    !this._isBlock && this.setDir(this._aimDir)\r\n                } else {\r\n                    // console.log(\"逃跑\")\r\n                    !this._isBlock && this.setDir(this._aimDir.rotate(180))\r\n                }\r\n            }\r\n            return\r\n        }\r\n        if (GameApp.dataManager.globalData.gasConfig != null) {\r\n            let dir = cc.v2(GameApp.dataManager.globalData.gasConfig.safePosition).sub(cc.v2(this.node.position))\r\n            let distance = dir.mag()\r\n            if (GameApp.dataManager.globalData.gasConfig.gasCircle > 0 && distance > GameApp.dataManager.globalData.gasConfig.gasCircle / 2) {\r\n                this._inGasTimer -= dt\r\n                if (this._inGasTimer < 0) {\r\n                    this._inGasTimer = this._inGasInterval\r\n                    this.beDamage(5, -1)\r\n                }\r\n                this._isGas = true\r\n                !this._isBlock && this.setDir(dir.normalize())\r\n                return\r\n            } else {\r\n                this._isGas = false\r\n            }\r\n        } else {\r\n            this._isGas = false\r\n        }\r\n\r\n        if (this._desTime < 0) {\r\n            //1 1 不找  1 0 找  0 1 不找  0 0 不找\r\n            if (!this._isGas && !this._mapNoGun && !this._haveGun) {\r\n                this._desTime = 0.3\r\n                // console.log(\"找枪\")\r\n                !this._isBlock && this.searchGun()\r\n            } else {\r\n                if (!this._isGas && GameApp.dataManager.globalData.isInGame && !this._mapNoBox && this._haveGun) {\r\n                    this._desTime = 0.3\r\n                    // console.log(\"找箱子\")\r\n                    this.searchBox()\r\n                } else {\r\n                    // console.log(\"巡逻\")\r\n                    this._desTime = Tools.randomNum(1, 3)\r\n                    var desDir = cc.v2(0, 1).rotate(cc.misc.radiansToDegrees(Tools.randomNum(0, 360)))\r\n                    !this._isBlock && this.setDir(desDir)\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    searchGun() {\r\n        var allGunArr = GameApp.dataManager.globalData.allGunArr.concat()\r\n        var minDis = 1000000;\r\n        var index = -1;\r\n        for (let i = 0; i < allGunArr.length; i++) {\r\n            var distance = cc.v2(allGunArr[i].position).sub(cc.v2(this.node.position)).mag()\r\n            if (distance < minDis) {\r\n                if (GameApp.dataManager.globalData.gasConfig != null) {\r\n                    let dirDistance = cc.v2(GameApp.dataManager.globalData.gasConfig.safePosition).sub(cc.v2(allGunArr[i].position)).mag()\r\n                    if (dirDistance > GameApp.dataManager.globalData.gasConfig.gasCircle / 2) {\r\n                        continue\r\n                    }\r\n                }\r\n                minDis = distance\r\n                index = i\r\n            }\r\n        }\r\n        var dir = null\r\n        if (index == -1) {\r\n            this._mapNoGun = true\r\n        } else {\r\n            var aimGun = allGunArr[index]\r\n            dir = cc.v2(aimGun.position).sub(cc.v2(this.node.position)).normalize()\r\n        }\r\n        this.setDir(dir)\r\n    },\r\n    searchBox() {\r\n        var allBoxArr = GameApp.dataManager.globalData.allBoxArr.concat()\r\n        var minDis = 1000000;\r\n        var index = -1;\r\n        for (let i = 0; i < allBoxArr.length; i++) {\r\n            var distance = cc.v2(allBoxArr[i].position).sub(cc.v2(this.node.position)).mag()\r\n            if (distance < 10) {\r\n                this.setDir(cc.v2(0, 0))\r\n                return;\r\n            }\r\n            if (distance < minDis) {\r\n                if (GameApp.dataManager.globalData.gasConfig != null) {\r\n                    let dirDistance = cc.v2(GameApp.dataManager.globalData.gasConfig.safePosition).sub(cc.v2(allBoxArr[i].position)).mag()\r\n                    if (dirDistance > GameApp.dataManager.globalData.gasConfig.gasCircle / 2) {\r\n                        continue\r\n                    }\r\n                }\r\n                minDis = distance\r\n                index = i\r\n            }\r\n        }\r\n        var dir = cc.v2(0, 0)\r\n        if (index == -1) {\r\n            this._mapNoBox = true\r\n        } else {\r\n            var aimBox = allBoxArr[index]\r\n            dir = cc.v2(aimBox.position).sub(cc.v2(this.node.position)).normalize()\r\n        }\r\n        this.setDir(dir)\r\n    },\r\n    setSpeedType(_type) {\r\n        if (this._isDie) return;\r\n        if (this._speedType != _type) {\r\n            this._speedType = _type\r\n\r\n            var arr = this._choosedSkinId < 21 ? ['await', 'run2', 'run2'] : ['await_fight_1', 'run', 'run']\r\n            this.roleAnim.setAnimation(0, arr[_type], true)\r\n        }\r\n    },\r\n    setDir(_dir) {\r\n        if (this._isDie) return;\r\n        if (_dir && _dir.mag() == 0) {\r\n            this.setSpeedType(SpeedType.STOP)\r\n        } else {\r\n            this.setSpeedType(SpeedType.FAST)\r\n        }\r\n        this.moveDir = _dir\r\n        if (this._isAim) return\r\n        this.setGunDir(_dir)\r\n    },\r\n    setGunDir(_dir) {\r\n        if (_dir == null) {\r\n            _dir = this.moveDir\r\n        }\r\n        this._gunDir = _dir\r\n        this._aimDir = _dir\r\n        if (!this._haveGun) return\r\n        this.gunNode.rotation = -cc.misc.radiansToDegrees(\r\n            Math.atan2(_dir.y, _dir.x)\r\n        );\r\n        let theAngle = 90 - this.gunNode.rotation\r\n\r\n        if (theAngle > 180 || theAngle < 0) {\r\n            this.gunNode.scaleY = -1\r\n        } else {\r\n            this.gunNode.scaleY = 1\r\n        }\r\n    },\r\n    update(dt) {\r\n        if (this._isDie) return;\r\n        this.doParser(dt)\r\n        switch (this._speedType) {\r\n            case SpeedType.STOP:\r\n                this._moveSpeed = this.stopSpeed;\r\n                break;\r\n            case SpeedType.NORMAL:\r\n                this._moveSpeed = this.normalSpeed;\r\n                // this._moveSpeed = this.fastSpeed;\r\n                break;\r\n            case SpeedType.FAST:\r\n                this._moveSpeed = this._curSpeed + Math.floor(this._curSpeed * this.equipItemAttr[EquipType.speed]);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.move(dt);\r\n\r\n        if (this._isProtect) return;\r\n\r\n        this._aimTimer -= dt\r\n        if (this._aimTimer < 0) {\r\n            this._aimTimer = this._aimInterval\r\n            this.aimToNearest()\r\n        }\r\n        if (this._isAim) {\r\n            this._shootTimer -= dt\r\n            if (this._shootTimer < 0 && !this._reloadFlag) {\r\n                this._shootTimer = this._shootInterval\r\n                this.shoot()\r\n            }\r\n        }\r\n\r\n        if (this._reloadFlag) {\r\n            this._reloadTimer -= dt\r\n            if (this._reloadFlag && this._reloadTimer < 0) {\r\n                this._reloadFlag = false\r\n                this.reloadAmo()\r\n            }\r\n        }\r\n\r\n    },\r\n    lateUpdate(dt) {\r\n        // this.mainC.node.setPosition(this.player.position)\r\n        // this.testC.node.setPosition(this.player.position)\r\n        // GameApp.uiManager.mapCamera.node.setPosition(this.node.position)\r\n        // this.mipmapCamera.node.setPosition(this.node.position)\r\n    },\r\n    aimToNearest() {\r\n        // return\r\n        if (!this._haveGun) {\r\n            this.gunData.range = 400\r\n        }\r\n        var allRoleArr = GameApp.dataManager.globalData.allRoleArr.concat()\r\n        // for (let i = 0; i < allRoleArr.length; i++) {\r\n        //     if (allRoleArr[i].skinData.skinid == this.skinData.skinid) {\r\n        //         allRoleArr.splice(i, 1)\r\n        //         break\r\n        //     }\r\n        // }\r\n        Tools.removeArray(allRoleArr, this.getComponent(\"Enemy\"))\r\n        var minDis = 1000000;\r\n        var index = -1;\r\n        for (let i = 0; i < allRoleArr.length; i++) {\r\n            var distance = cc.v2(allRoleArr[i].node.position).sub(cc.v2(this.node.position)).mag()\r\n            if (distance < minDis && distance < this.gunData.range * 1.4) {\r\n                minDis = distance\r\n                index = i\r\n            }\r\n        }\r\n        var dir = null\r\n        if (index == -1) {\r\n            this._isAim = false\r\n        } else {\r\n            var aimEnemy = allRoleArr[index].node\r\n            dir = cc.v2(aimEnemy.position).sub(cc.v2(this.node.position)).normalize()\r\n            this._isAim = true\r\n        }\r\n        this.setGunDir(dir)\r\n    },\r\n\r\n    shoot() {\r\n        if (!this._haveGun) return\r\n        if (this.reduceAmo()) {\r\n            this.gunAnim.setAnimation(0, 'attack_' + this.gunData.skinname, false)\r\n            var power = Math.ceil(this.gunData.power * (this._curDamage + this.equipItemAttr[EquipType.damage]))\r\n            var isCrit = false\r\n            if (Tools.isCrit(this._curCrit + this.equipItemAttr[EquipType.crit])) {\r\n                power *= 2\r\n                isCrit = true\r\n            }\r\n\r\n            if (this.gunData.weaponid == 1002) {\r\n                GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('shot_shoot', 0.3, false)\r\n                var bullet1 = cc.instantiate(this.bulletPrefab)\r\n                var bullet2 = cc.instantiate(this.bulletPrefab)\r\n                var bullet3 = cc.instantiate(this.bulletPrefab)\r\n                let bulletPos = this.node.parent.parent.convertToNodeSpaceAR(this.gunNode.children[0].convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                bullet1.parent = bullet2.parent = bullet3.parent = this.node.parent.parent\r\n                bullet1.setPosition(bulletPos)\r\n                bullet2.setPosition(bulletPos)\r\n                bullet3.setPosition(bulletPos)\r\n                bullet1.rotation = this.gunNode.rotation\r\n                bullet2.rotation = this.gunNode.rotation + 30\r\n                bullet3.rotation = this.gunNode.rotation - 30\r\n                var cloneGunDir = cc.v2(this._gunDir)\r\n                var bulletC1 = bullet1.getComponent('Bullet')\r\n                bulletC1._belongTag = this._pbc.tag\r\n                bulletC1._belongName = this.thisName\r\n                bulletC1._flyDir = cloneGunDir\r\n                bulletC1.init(this.gunData, power, isCrit)\r\n                var bulletC2 = bullet2.getComponent('Bullet')\r\n                bulletC2._belongTag = this._pbc.tag\r\n                bulletC2._belongName = this.thisName\r\n                bulletC2._flyDir = cloneGunDir.rotate(-cc.misc.degreesToRadians(30))\r\n                bulletC2.init(this.gunData, power, isCrit)\r\n                var bulletC3 = bullet3.getComponent('Bullet')\r\n                bulletC3._belongTag = this._pbc.tag\r\n                bulletC3._belongName = this.thisName\r\n                bulletC3._flyDir = cloneGunDir.rotate(-cc.misc.degreesToRadians(-30))\r\n                bulletC3.init(this.gunData, power, isCrit)\r\n            } else {\r\n                if (this.gunData.weaponid == 1003) {\r\n                    GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('charge_shoot', 0.3, false)\r\n                } else if (this.gunData.weaponid == 1005) {\r\n                    GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('missile_shoot', 0.3, false)\r\n                }\r\n                var bullet = cc.instantiate(this.bulletPrefab)\r\n                let bulletPos = this.node.parent.parent.convertToNodeSpaceAR(this.gunNode.children[0].convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                bullet.parent = this.node.parent.parent\r\n                bullet.setPosition(bulletPos)\r\n                bullet.rotation = this.gunNode.rotation\r\n                var bulletC = bullet.getComponent('Bullet')\r\n                bulletC._belongTag = this._pbc.tag\r\n                bulletC._belongName = this.thisName\r\n                bulletC._flyDir = this._gunDir\r\n                bulletC.init(this.gunData, power, isCrit)\r\n            }\r\n            this.updateAmoShow()\r\n        } else {\r\n            this.reload()\r\n        }\r\n        if (this._curAmoNum == 0) {\r\n            this.reload()\r\n        }\r\n    },\r\n    reduceAmo() {\r\n        var a = this._curAmoNum - 1\r\n        if (a < 0) {\r\n            this._curAmoNum = 0\r\n            this.updateAmoShow()\r\n            return false\r\n        } else {\r\n            this._curAmoNum = a\r\n            this.updateAmoShow()\r\n            return true\r\n        }\r\n    },\r\n    reload() {\r\n        if (!this._haveGun) return\r\n        if (this._reloadFlag) return;\r\n        GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('reload', 0.6)\r\n        this.gunAnim.setAnimation(0, 'reload_' + this.gunData.skinname, false)\r\n        this._reloadTimer = this._reloadInterval\r\n        this._reloadFlag = true\r\n    },\r\n    reloadAmo() {\r\n        this._curAmoNum = this._maxAmoNum\r\n        this.updateAmoShow()\r\n    },\r\n    updateAmoShow() {\r\n        this.amoBar.progress = this._curAmoNum / this._maxAmoNum\r\n    },\r\n    updateHpShow() {\r\n        this.hpBar.progress = this._curHp / this._maxHp\r\n    },\r\n    equipWeapon(_kind) {\r\n        GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('pick_item', 0.6)\r\n        this.gunData = GameApp.dataManager.jsonData.WeaponData[_kind]\r\n        this._shootInterval = this.gunData.shootdelay\r\n        this._reloadInterval = this.gunData.reloaddelay\r\n        this._maxAmoNum = this.gunData.clipnum\r\n        this.reloadAmo()\r\n        this.gunNode.active = true\r\n        if (_kind < 3) {\r\n            this.gunAnim.skeletonData = GameApp.uiManager.gunSkinDataGroup[0]\r\n        } else {\r\n            this.gunAnim.skeletonData = GameApp.uiManager.gunSkinDataGroup[1]\r\n        }\r\n        this.gunAnim.setSkin(this.gunData.skinname)\r\n        this._haveGun = true\r\n        this.setGunDir(this.moveDir)\r\n        // this.gunAnim.setAnimation(0, 'attack_' + this.gunData.skinname, false)\r\n    },\r\n    getItem() {\r\n\r\n    },\r\n    onBeginContact(contact, self, other) {\r\n        if (this._isDie) return\r\n        if (self.tag == Tags.empty) return;\r\n        if (other.tag == Tags.item) {\r\n            var groundItem = other.node.getComponent('GroundItem')\r\n            if (groundItem.itemType._type == ItemType.weapon) {\r\n                var _kind = groundItem.itemType._kind\r\n                if (!this._haveGun) {\r\n                    Tools.removeArray(GameApp.dataManager.globalData.allGunArr, other.node)\r\n                    this.equipWeapon(_kind)\r\n                    other.node.destroy()\r\n                } else {\r\n                    // let _param = {\r\n                    //     _type: ItemType.weapon,\r\n                    //     _kind: GameApp.dataManager.jsonData.WeaponData.indexOf(this.gunData)\r\n                    // }\r\n                    // groundItem.init(_param)\r\n                }\r\n                // this.equipWeapon(_kind)\r\n            } else if (groundItem.itemType._type == ItemType.item) {\r\n                this.getItem()\r\n            }\r\n        } else if (other.tag == Tags.bullet) {\r\n            if (!GameApp.dataManager.globalData.isInGame) return;\r\n            var bC = other.node.getComponent('Bullet')\r\n            if (bC._belongTag == self.tag) return\r\n            if (other.node == this.lastHitBullet) return;\r\n            this.lastHitBullet = other.node\r\n            this.beDamage(bC._power, bC._belongTag, bC._belongName, bC._isCrit, bC.gunData.weaponid)\r\n        } else if (other.tag == Tags.collider) {\r\n            this._isBlock = true\r\n            this.moveDir && this.moveDir.rotateSelf(cc.misc.degreesToRadians(Tools.randomNum(90, 180)))\r\n            this.scheduleOnce(() => {\r\n                this._isBlock = false\r\n            }, 0.5)\r\n        } else if (other.tag == Tags.boom) {\r\n            this.beDamage(999, -2)\r\n        }\r\n    },\r\n    reduceHp(_num) {\r\n        var a = this._curHp - _num\r\n        if (a <= 0) {\r\n            this._curHp = 0\r\n            this.updateHpShow()\r\n            return false\r\n        } else {\r\n            this._curHp = a\r\n            this.updateHpShow()\r\n            return true\r\n        }\r\n    },\r\n    beDamage(_power, _belongIndex, _belongName, _isCrit, _weaponid) {\r\n        GameApp.uiManager.isInMapSight(this.node) && GameApp.uiManager.showGameObject(\"InfoLabel\", (node) => {\r\n            var originPos = node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0.5, 0.5)))\r\n            node.setPosition(originPos)\r\n            var _isDef = Math.ceil(_power * this._curDef) + Math.ceil(_power * this.equipItemAttr[EquipType.def])\r\n            _power -= _isDef\r\n            var str = \"<color=red>-\" + _power + \"</color>\"\r\n            if (_isCrit) {\r\n                str = \"<color=red>暴击-\" + _power + \"</color>\"\r\n            }\r\n            if (_isDef) {\r\n                str += \"<color=#0fffff>减伤\" + _isDef + \"</color>\"\r\n            }\r\n            node.getComponent(cc.RichText).string = \"<b>\" + str + \"</b>\"\r\n\r\n            let desPos = cc.v2(Tools.randomNum(60, 100), Tools.randomNum(60, 100))\r\n            let bezier = [originPos, cc.v2(originPos.x + desPos.x - 20, originPos.y + desPos.y + 20), originPos.add(desPos)];\r\n            let seq = cc.sequence(cc.spawn(cc.fadeIn(0.2), cc.scaleTo(0.3, 1.5), cc.bezierTo(0.3, bezier)), cc.delayTime(0.5), cc.fadeOut(0.3), cc.callFunc(() => {\r\n                node.destroy()\r\n            }))\r\n            node.runAction(seq)\r\n        }, this.node.parent.parent)\r\n        // console.log(GameApp.dataManager.globalData.allRoleArr)\r\n        if (this.reduceHp(_power)) {\r\n\r\n        } else {\r\n            GameApp.uiManager.isInMapSight(this.node) && GameApp.audioManager.playEffect('maleDeath', 0.5)\r\n            this.node.parent = GameApp.uiManager.getGame(\"GameMap\").getChildByName(\"DeadObjectNode\")\r\n            this._pbc.enabled = false\r\n            this._isDie = true\r\n            if (_belongIndex == -1) {\r\n                GameApp.uiManager.showToast(this.thisName + \" 被毒出局\")\r\n            } else if (_belongIndex == -2) {\r\n                GameApp.uiManager.showToast(this.thisName + \" 被轰炸出局\")\r\n            } else {\r\n                var killNum = GameApp.dataManager.addKillNum(_belongIndex, _belongName)\r\n                if (_belongName == GameApp.dataManager.userData.playerName) {\r\n                    _belongName = \"<color=#0fffff>\" + _belongName + \"</color>\"\r\n                }\r\n                if (killNum > 1) {\r\n                    var soundIndex = killNum > 5 ? 5 : killNum\r\n                    GameApp.audioManager.playEffect('kill' + soundIndex, 0.5)\r\n                    GameApp.uiManager.showToast(_belongName, null, killNum)\r\n                } else {\r\n                    GameApp.uiManager.showToast(_belongName + \" 击杀了 \" + this.thisName)\r\n                }\r\n                //任务相关\r\n                if (_belongIndex == 1) {\r\n                    cc.log(\"玩家杀人了\")\r\n                    GameApp.dataManager.addActivityNum(1, 1)\r\n                    if (_weaponid == 1102) {\r\n                        GameApp.dataManager.addActivityNum(0, 1)\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (this._haveGun) {\r\n                var theParentC = GameApp.uiManager.gameRoot.children[0].getComponent(\"GameMap\")\r\n                GameApp.uiManager.showGameObject(\"GroundItem\", (node) => {\r\n                    let ddd = theParentC.allGunNode.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0, 0)))\r\n                    node.parent = theParentC.allGunNode\r\n                    node.setPosition(ddd)\r\n                    let _param = {\r\n                        _type: ItemType.weapon,\r\n                        _kind: Tools.getIndex(GameApp.dataManager.jsonData.WeaponData, this.gunData)\r\n                    }\r\n                    // console.log(_param._kind)\r\n                    node.getComponent('GroundItem').init(_param)\r\n                    GameApp.dataManager.globalData.allGunArr.push(node)\r\n                })\r\n            }\r\n            this.node.stopActionByTag(1)\r\n            // for (var i in GameApp.dataManager.globalData.allRoleArr) {\r\n            //     if (GameApp.dataManager.globalData.allRoleArr[i].skinData.skinid == this.skinData.skinid) {\r\n            //         GameApp.dataManager.globalData.allRoleArr.splice(i, 1)\r\n            //         break;\r\n            //     }\r\n            // }\r\n            var arr = this._choosedSkinId < 21 ? ['dead'] : ['dead2']\r\n            this.roleAnim.setAnimation(0, arr[0], false)\r\n            this.gunNode.active = false\r\n            Tools.removeArray(GameApp.dataManager.globalData.allRoleArr, this.node.getComponent('Enemy'))\r\n            GameApp.eventManager.emit(EventNames.EVENT_SHOW_ALLROLENUM_UI)\r\n        }\r\n    },\r\n\r\n});\r\n"]}